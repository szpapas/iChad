o: ActiveSupport::Cache::Entry	:@expires_in0:@value{	"source"Ñ/*

This file is part of Ext JS 4

Copyright (c) 2011 Sencha Inc

Contact:  http://www.sencha.com/contact

GNU General Public License Usage
This file may be used under the terms of the GNU General Public License version 3.0 as published by the Free Software Foundation and appearing in the file LICENSE included in the packaging of this file.	Please review the following information to ensure the GNU General Public License version 3.0 requirements will be met: http://www.gnu.org/copyleft/gpl.html.

If you are unsure which license is appropriate for your use, please contact the sales department at http://www.sencha.com/contact.

*/
/*!
 * Ext JS Library 4.0
 * Copyright(c) 2006-2011 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */



Ext.define('MyDesktop.BorrowMan', {
	extend: 'Ext.ux.desktop.Module',
	requires: [
		'*',
		'Ext.tree.*',
		'Ext.data.*',
		'Ext.window.MessageBox'
		//'Ext.QuickTips'
	],

	id:'borrowman',

	init : function(){
		this.launcher = {
			text: 'å€Ÿé˜…ç®¡ç†',
			iconCls:'borrowman',
			handler : this.createWindow,
			scope: this
		}
	},
	//Ext.QuickTips.init();
	
	createWindow : function(){		
		var jyqq_add_change='1';
		var jydj_jyzt='2';
		insert_qx="";
		zxjyid="";
		function Run(strPath){
		   //try        
		   {        
		    var objShell = new ActiveXObject("wscript.shell");        
		    objShell.Run(strPath);        
		    objShell = null;    
		    //alert("ok");  
		   }        
		   //catch(e)     
		   //{     
		   //     alert('æ‰¾ä¸åˆ°æ–‡ä»¶"'+strPath+'"(æˆ–å®ƒçš„ç»„ä»¶ä¹‹ä¸€)ã€‚è¯·ç¡®å®šè·¯å¾„å’Œæ–‡ä»¶åæ˜¯å¦æ­£ç¡®.')        
		   //}        
		}
		var DispAj = function(record,add_new){
			var win = Ext.getCmp('archive_detail_win');
			if (win==null) {
				win = new Ext.Window({
					id : 'archive_detail_win',
					title: 'æ¡ˆå·è¯¦ç»†ä¿¡æ¯',
					//closeAction: 'hide',
					width: 370,
					height: 530,
					minHeight: 530,
					layout: 'fit',
					modal: true,
					plain: true,
					items: [{
						width: 370,
						height: 530,
						xtype:'form',
						layout: 'absolute',
						id : 'daglaj_form',
						items: [
							{
								xtype: 'label',
								text: 'æ¡£å·',
								x: 10,
								y: 10,
								width: 100
							},
							{
								xtype: 'label',
								text: 'ç›®å½•å·',
								x: 10,
								y: 40,
								width: 100
							},
							{
								xtype: 'label',
								text: 'åˆ†ç±»å·',
								x: 10,
								y: 70,
								width: 100
							},
							{
								xtype: 'label',
								text: 'æ¡ˆå·å·',
								x: 10,
								y: 100,
								width: 100
							},
							{
								xtype: 'label',
								text: 'æ¡ˆå·æ ‡é¢˜',
								x: 10,
								y: 130,
								width: 100
							},
							{
								xtype: 'label',
								text: 'å¹´åº¦',
								x: 10,
								y: 190,
								width: 100
							},
							{
								xtype: 'label',
								text: 'ä¿ç®¡æœŸé™',
								x: 10,
								y: 220,
								width: 100
							},
							{
								xtype: 'label',
								text: 'ä»¶æ•°',
								x: 10,
								y: 250,
								width: 100
							},
							{
								xtype: 'label',
								text: 'é¡µæ•°',
								x: 10,
								y: 280,
								width: 100
							},
							{
								xtype: 'label',
								text: 'èµ·å¹´æœˆ',
								x: 10,
								y: 310,
								width: 100
							},
							{
								xtype: 'label',
								text: 'æ­¢å¹´æœˆ',
								x: 10,
								y: 340,
								width: 100
							},
							{
								xtype: 'label',
								text: 'å¤‡æ³¨',
								x: 10,
								y: 370,
								width: 100
							},
							{
								xtype: 'textfield',
								hidden : true,
								name : 'id' ,
								id:'aj_id'										
							},
							{
								xtype: 'textfield',
								hidden : true,
								name : 'qzh',
								id:'aj_qzh'											
							},
							{
								xtype: 'textfield',
								hidden : true,
								name : 'dalb',
								id:'aj_dalb'											
							},
							{
								xtype: 'textfield',
								x: 130,
								y: 10,
								width: 200,
								name: 'dh',
								id:'aj_dh'
							},
							{
								xtype: 'textfield',
								x: 130,
								y: 40,
								width: 200,
								name: 'mlh',
								id:'aj_mlh'
							},
							{
								xtype: 'textfield',
								x: 130,
								y: 70,
								width: 200,
								name: 'flh',
								id:'aj_flh'
							},
							{
								xtype: 'textfield',
								x: 130,
								y: 100,
								width: 200,
								name: 'ajh',
								id:'aj_ajh'
							},
							{
								xtype: 'textarea',
								x: 130,
								y: 130,
								width: 200,
								name: 'tm',
								height: 50,
								id:'aj_tm'
							},
							{
								xtype: 'textfield',
								x: 130,
								y: 190,
								width: 200,
								name: 'nd',
								id:'aj_nd'

							},
							{
								xtype: 'combo',
								x: 130,
								y: 220,
								width: 200,
								name: 'bgqx',
								store: bgqx_store,
								emptyText:'è¯·é€‰æ‹©',
								mode: 'remote',
								minChars : 2,
								valueField:'text',
								displayField:'text',
								triggerAction:'all',
								id:'aj_bgqx'

							},
							{
								xtype: 'textfield',
								x: 130,
								y: 250,
								width: 200,
								name: 'js',
								id:'aj_js'
							},
							{
								xtype: 'textfield',
								x: 130,
								y: 280,
								width: 200,
								name: 'ys',
								id:'aj_ys'
							},
							{
								xtype: 'textfield',
								x: 130,
								y: 310,
								width: 200,
								name: 'qny',
								id:'aj_qny'
							},
							{
								xtype: 'textfield',
								x: 130,
								y: 340,
								width: 200,
								name: 'zny',
								id:'aj_zny'
							},
							{
								xtype: 'textarea',
								x: 130,
								y: 370,
								width: 200,
								name: 'bz',
								height: 80,
								id:'aj_bz'
							}
						],
						buttons:[
							{
								xtype: 'button',
								cls: 'exit',
								text:'é€€å‡º',
								handler: function() {
									//this.up('window').hide();
									Ext.getCmp('archive_detail_win').close();
								}
							}]
					}]
				});
			}
			if(add_new==false){
			//è®¾ç½®æ•°æ®
				Ext.getCmp('daglaj_form').getForm().setValues(record.data);

			}else{

				Ext.getCmp('button_aj_add').text="æ–°å¢";
				Ext.getCmp('aj_dh').setValue(record.data.dh);
				Ext.getCmp('aj_qzh').setValue(record.data.qzh);
				Ext.getCmp('aj_mlh').setValue(record.data.mlh);
				Ext.getCmp('aj_flh').setValue(record.data.flh);
				Ext.getCmp('aj_dalb').setValue(record.data.dalb);
				Ext.getCmp('aj_ajh').setValue("");
				Ext.getCmp('aj_bgqx').setValue("");
				Ext.getCmp('aj_nd').setValue("");
				Ext.getCmp('aj_tm').setValue("");
				Ext.getCmp('aj_qny').setValue("");
				Ext.getCmp('aj_zny').setValue("");
				Ext.getCmp('aj_js').setValue("");
				Ext.getCmp('aj_ys').setValue("");
				Ext.getCmp('aj_bz').setValue("");
			}
			//è®¾ç½®æ•°æ®

			win.show();
		};	
	    var desktop = this.app.getDesktop();
		Ext.regModel('dalb_model_print', {
			fields: [
				{name: 'id',		type: 'integer'},
				{name: 'lbmc',		type: 'string'}
			]
		});
		var dalb_store_print = Ext.create('Ext.data.Store', {
				id:'dalb_store_print',
				model : 'dalb_model_print',
				proxy: {
					type: 'ajax',
					url : '/desktop/get_dalb_print_grid',
					extraParams: {userid:user_id},
					reader: {
						type: 'json',
						root: 'rows',
						totalProperty: 'results'
					}
				}				
		});
		//dalb_store_print.load();	
		function get_mlqx_NodesChecked(node){
			//insert_qx="";
			//è·å–ç”¨æˆ·ç›®å½•æƒé™æ ‘
			if (node.childNodes.size() == 0) return;
			node.eachChild(function(n){
				if(n.data.leaf==true){
	   				if (n.data.checked==true){
						if (insert_qx==""){
							insert_qx= n.data.id 
						}else{
							insert_qx=insert_qx+ "$" + n.data.id 
						}
					};
   				};
				get_mlqx_NodesChecked(n);
			});


		};
	    var win = desktop.getWindow('borrowman');
		var jydjform= new Ext.FormPanel({
				id : 'jydj_form',
				fileUpload: true,
				width: 1000,
				height : 100,
				autoHeight: true,
				bodyStyle: 'padding: 5px 5px 5px 5px;',
				labelWidth: 0,
				defaults: {
					anchor: '100%',
					allowBlank: false,
					msgTarget: 'side'
				},
				layout : 'absolute',
				tbar:[							  
					{	
						xtype:'button',text:'ç™»è®°',tooltip:'ç™»è®°',id:'dj',iconCls:'dj',
						handler: function() {
							var grid = Ext.getCmp('jydjlist_dj_grid');
							var data=grid.getStore().data							
							//var data=grid.getSelectionModel().getSelection();
							//alert(data.length);
							if (data.length==0){
								alert("æ‚¨æœ€å°‘è¦é€‰æ‹©ä¸€æ¡æ¡ˆå·è¿›è¡Œç™»è®°ã€‚");
							}else{
								var pars=Ext.getCmp('jydj_form').getForm().getValues();								
								if (pars['jyr']!='' || pars['jydw']!=''){
									var ids=[];
									//Ext.Array.each(data,function(items){
									//	ids.push(items.get("id"));
								
									//});
									for(k=0;k<data.length;k++){
										ids.push(data.items[k].data.id);
									};
									//alert(ids);
									Ext.getCmp('jyzt').setValue('2');
									Ext.getCmp('jy_aj_list').setValue(ids);									
									new Ajax.Request("/desktop/insert_jylc", { 
										method: "POST",
										parameters: Ext.getCmp('jydj_form').getValues(),
										onComplete:	 function(request) {
											if (request.responseText=='success'){
												alert("ç™»è®°æˆåŠŸã€‚");
												//grid.removeAll();
												grid.store.removeAll();
												Ext.getCmp('jyr').setValue("");
												Ext.getCmp('jydw').setValue("");
												Ext.getCmp('lyxg').setValue("");
												Ext.getCmp('bz').setValue("");
												Ext.getCmp('cdlr').setValue("");
												Ext.getCmp('zj').setValue("");
												Ext.getCmp('fyys').setValue("0");
												Ext.getCmp('zcys').setValue("");
												//grid.removeAll;
												//grid.store.remove(1);
												//data.removeAll;
											}else{
												alert("ç™»è®°å¤±è´¥ï¼Œè¯·é‡æ–°ç™»è®°ã€‚");
											}
										}
									});
								}else{
									alert('å€Ÿé˜…äººå’Œå€Ÿé˜…å•ä½ä¸èƒ½åŒæ—¶ä¸ºç©ºã€‚');
								}																
							}
						}
					},
					{	
						xtype:'button',text:'é˜…è§ˆ',tooltip:'é˜…è§ˆ',id:'yl',iconCls:'yl',
						
							
							handler: function() {
								var grid = Ext.getCmp('jydjlist_dj_grid');
								var data=grid.getStore().data							
								//var data=grid.getSelectionModel().getSelection();
								//alert(data.length);
								if (data.length==0){
									alert("æ‚¨æœ€å°‘è¦é€‰æ‹©ä¸€æ¡æ¡ˆå·è¿›è¡Œç™»è®°ã€‚");
								}else{
									var pars=Ext.getCmp('jydj_form').getForm().getValues();								
									if (pars['jyr']!='' || pars['jydw']!=''){
										var ids=[];
										//Ext.Array.each(data,function(items){
										//	ids.push(items.get("id"));

										//});
										for(k=0;k<data.length;k++){
											ids.push(data.items[k].data.id);
										};
										//alert(ids);
										Ext.getCmp('jyzt').setValue('4');
										Ext.getCmp('jy_aj_list').setValue(ids);									
										new Ajax.Request("/desktop/insert_jylc", { 
											method: "POST",
											parameters: Ext.getCmp('jydj_form').getValues(),
											onComplete:	 function(request) {
												if (request.responseText=='success'){
													alert("ç™»è®°æˆåŠŸã€‚");
													//grid.removeAll();
													grid.store.removeAll();
													Ext.getCmp('jyr').setValue("");
													Ext.getCmp('jydw').setValue("");
													Ext.getCmp('lyxg').setValue("");
													Ext.getCmp('bz').setValue("");
													Ext.getCmp('cdlr').setValue("");
													Ext.getCmp('zj').setValue("");
													Ext.getCmp('fyys').setValue("0");
													Ext.getCmp('zcys').setValue("");
													//grid.removeAll;
													//grid.store.remove(1);
													//data.removeAll;
												}else{
													alert("ç™»è®°å¤±è´¥ï¼Œè¯·é‡æ–°ç™»è®°ã€‚");
												}
											}
										});
									}else{
										alert('å€Ÿé˜…äººå’Œå€Ÿé˜…å•ä½ä¸èƒ½åŒæ—¶ä¸ºç©ºã€‚');
									}																
								}

								
							}							
						
					},
					{	
						xtype:'button',text:'è¯»å–èº«ä»½è¯',tooltip:'è¯»å–èº«ä»½è¯',id:'jydj_sfz',iconCls:'option',
						handler: function() {	
									//Run("e:\\sfz.exe");
									//window.open('dacx/test.html','','height=500,width=800,top=150, left=100,scrollbars=yes,status=yes');
									new Ajax.Request("/desktop/get_sfz", { 
										method: "POST",
										//parameters: eval(insert_qx),
										onComplete:	 function(request) {
											reques=request.responseText.split(':');
											if (reques[0]=='success'){
												sfz=reques[1].split(";")
												Ext.getCmp('jydj_jyr').setValue(sfz[0]);
												Ext.getCmp('jydj_zj').setValue("èº«ä»½è¯ï¼š" + sfz[2]);
												Ext.getCmp('jydj_bz').setValue(sfz[1]);
											}else{
												alert(reques[1]);
											}
										}
									});																													
						}
					}],
				items: [{
					width: 370,
					height: 180,
					xtype:'form',
					border:false,
					layout: 'absolute',
					//id : 'jydj_form',
					items: [		{
										xtype: 'textfield',
										hidden : true,
										name : 'jyzt' ,
										id:'jyzt'										
									},
									{
										xtype: 'textfield',
										hidden : true,
										name : 'czrid' ,
										id:'czrid'										
									},
									{
										xtype: 'textfield',
										hidden : true,
										name : 'jy_aj_list' ,
										id:'jy_aj_list'										
									},
					                {
					                    xtype: 'textfield',
					                    name: 'jyr',
										id:'jydj_jyr',
					                    fieldLabel: '',
					                    x: 75,
					                    y: 5
					                },
					                {
					                    xtype: 'textfield',
					                    name: 'jydw',
					                    width: 465,
					                    fieldLabel: '',
					                    x: 295,
					                    y: 5
					                },
					                
					                {
					                    xtype: 'textfield',
					                    name: 'zj',
										id:'jydj_zj',
					                    width: 465,
					                    fieldLabel: '',
					                    x: 295,
					                    y: 30
					                },
					                {
					                    xtype: 'combobox',
					                    name: 'jylx',
					                    store: jydj_jylx_store,
										emptyText:'è¯·é€‰æ‹©',
										mode: 'remote',
										minChars : 2,
										valueField:'text',
										displayField:'text',
										triggerAction:'all',
					                    x: 75,
					                    y: 30
					                },
					                {
					                    xtype: 'combobox',
					                    name: 'lymd',
					                    store: jydj_lymd_store,
										emptyText:'è¯·é€‰æ‹©',
										mode: 'remote',
										minChars : 2,
										valueField:'text',
										displayField:'text',
										triggerAction:'all',
					                    x: 75,
					                    y: 55
					                },
					                {
					                    xtype: 'textfield',
					                    name: 'cdlr',
										id:'cdlr',
					                    width: 465,
					                    fieldLabel: '',
					                    x: 295,
					                    y: 80
					                },
					                {
					                    xtype: 'textfield',
					                    name: 'lyxg',
					                    width: 465,
					                    fieldLabel: '',
					                    x: 295,
					                    y: 55
					                },
					                {
					                    xtype: 'label',
					                    height: 20,
					                    width: 55,
					                    text: 'å€Ÿé˜…äººï¼š',
					                    x: 15,
					                    y: 5
					                },
					                {
					                    xtype: 'label',
					                    height: 20,
					                    width: 65,
					                    text: 'å€Ÿé˜…å•ä½ï¼š',
					                    x: 230,
					                    y: 5
					                },
									{
					                    xtype: 'label',
					                    height: 25,
					                    width: 65,
					                    text: 'å¤å°é¡µæ•°ï¼š',
					                    x: 770,
					                    y: 5
					                },
									{
					                    xtype: 'textfield',
					                    name: 'fyys',
					                    fieldLabel: '',
					                    x: 840,
					                    y: 5
					                },
									{
					                    xtype: 'label',
					                    height: 20,
					                    width: 65,
					                    text: 'æ‘˜æŠ„é¡µæ•°ï¼š',
					                    x: 770,
					                    y: 30
					                },
									{
					                    xtype: 'textfield',
					                    name: 'zcys',
					                    fieldLabel: '',
					                    x: 840,
					                    y: 30
					                },
					                {
					                    xtype: 'combobox',
					                    name: 'jyqx',
					                    store: jydj_jyqx_store,
										emptyText:'è¯·é€‰æ‹©',
										mode: 'remote',
										minChars : 2,
										valueField:'value',
										displayField:'text',
										triggerAction:'all',
					                    x: 75,
					                    y: 80
					                },
					                {
					                    xtype: 'label',
					                    height: 25,
					                    width: 65,
					                    text: 'å€Ÿé˜…ç±»å‹ï¼š',
					                    x: 15,
					                    y: 30
					                },
					                {
					                    xtype: 'label',
					                    height: 20,
					                    width: 65,
					                    text: 'åˆ©ç”¨ç›®çš„ï¼š',
					                    x: 15,
					                    y: 55
					                },
					                {
					                    xtype: 'label',
					                    height: 20,
					                    width: 70,
					                    text: 'å€Ÿé˜…æœŸé™ï¼š',
					                    x: 15,
					                    y: 80
					                },
					                {
					                    xtype: 'label',
					                    height: 25,
					                    width: 60,
					                    text: 'è¯ä»¶ï¼š',
					                    x: 230,
					                    y: 30
					                },
					                {
					                    xtype: 'label',
					                    height: 25,
					                    width: 60,
					                    text: 'æŸ¥æ¡£å†…å®¹ï¼š',
					                    x: 230,
					                    y: 80
					                },
					                {
					                    xtype: 'label',
					                    height: 25,
					                    width: 65,
					                    text: 'åˆ©ç”¨æ•ˆæœï¼š',
					                    x: 230,
					                    y: 55
					                },
					                
					                
					                {
					                    xtype: 'label',
					                    height: 20,
					                    width: 55,
					                    text: 'å¤‡æ³¨ï¼š',
					                    x: 770,
					                    y: 55
					                },
					                
					                {
					                    xtype: 'textfield',
					                    name: 'bz',
										id:'jydj_bz',
					                    width: 150,
					                    fieldLabel: '',
					                    x: 840,
					                    y: 55
					                }
					            ]}],
				
		});
			
		
		var qwjsform= new Ext.FormPanel({
				id : 'qwjs_form',
				fileUpload: true,
				width: 1000,
				height : 115,
				autoHeight: true,
				bodyStyle: 'padding: 5px 5px 5px 5px;',
				labelWidth: 0,
				defaults: {
					anchor: '100%',
					allowBlank: false,
					msgTarget: 'side'
				},
				layout : 'absolute',
				
				items: [{
					width: 1000,
					height: 115,
					xtype:'form',
					border:false,
					layout: 'absolute',
					//id : 'daglaj_form',
					items: [		
					                {
					                    xtype: 'textfield',
					                    id: 'mlh',
										name:'mlh',
					                    width: 140,
					                    fieldLabel: '',
					                    x: 65,
					                    y: 5
					                },
					                {
					                    xtype: 'textfield',
					                    id: 'ajh',
										name:'ajh',
					                    width: 145,
					                    fieldLabel: '',
					                    x: 270,
					                    y: 5
					                },
					                {
					                    xtype: 'textfield',
					                    id: 'ajtm',
										name:'ajtm',
					                    width: 185,
					                    fieldLabel: '',
					                    x: 495,
					                    y: 5
					                },
					                {
					                    xtype: 'textfield',
					                    id: 'wh',
										name:'wh',
					                    width: 140,
					                    fieldLabel: '',
					                    x: 65,
					                    y: 30
					                },
					                {
					                    xtype: 'textfield',
					                    id: 'zrz',
										name:'zrz',
					                    width: 145,
					                    fieldLabel: '',
					                    x: 270,
					                    y: 30
					                },
					                {
					                    xtype: 'textfield',
					                    id: 'tm',
										name:'tm',
					                    width: 185,
					                    fieldLabel: '',
					                    x: 495,
					                    y: 30
					                },
					                {
					                    xtype: 'button',
					                    height: 95,
					                    id: 'ss',
					                    width: 75,
					                    text: 'æœç´¢',
					                    x: 910,
					                    y: 5,
										handler: function() {
											var pars=this.up('panel').getForm().getValues();
											//var form = Ext.getCmp('qwjs_form').getForm();
											//pars = form.getValues('tm');
											var cx_tj;
											var cdlr;
											cx_tj='';
											if(pars['djh']!=''){
												cx_tj="{djh:'" + pars['djh'] + "'";
												cdlr="åœ°ç±å·ï¼š"+ pars['djh'];
											};
											if(pars['qlr']!=''){
												if (cx_tj!=''){
													cx_tj=cx_tj + ",qlr:'" + pars['qlr']+ "'";
													cdlr=cdlr + ",æƒåˆ©äººåç§°ï¼š"+ pars['qlr'];
												}else{
													cx_tj="{qlr:'" + pars['qlr']+ "'";
													cdlr="æƒåˆ©äººåç§°ï¼š"+ pars['qlr'];
												}
											};
											if(pars['tdzl']!=''){
												if (cx_tj!=''){
													cx_tj=cx_tj + ",tdzl:'" + pars['tdzl']+ "'";
													cdlr=cdlr + ",åœŸåœ°åº§è½ï¼š"+ pars['tdzl'];
												}else{
													cx_tj="{tdzl:'" + pars['tdzl']+ "'";
													cdlr="åœŸåœ°åº§è½ï¼š"+ pars['tdzl'];
												}
											};
											if(pars['zrz']!=''){
												if (cx_tj!=''){
													cx_tj=cx_tj + ",rzr:'" + pars['zrz']+ "'";
													cdlr=cdlr + ",è´£ä»»è€…ï¼š"+ pars['rzr'];
												}else{
													cx_tj="{rzr:'" + pars['zrz']+ "'";
													cdlr="è´£ä»»è€…ï¼š"+ pars['zrz'];
												}
											};
											if(pars['wh']!=''){
												if (cx_tj!=''){
													cx_tj=cx_tj + ",wh:'" + pars['wh']+ "'";
													cdlr=cdlr + ",æ–‡å·ï¼š"+ pars['wh'];
												}else{
													cx_tj="{wh:'" + pars['wh']+ "'";
													cdlr="æ–‡å·ï¼š"+ pars['wh'];
												}
											};
											if(pars['tm']!=''){
												if (cx_tj!=''){
													cx_tj=cx_tj + ",tm:'" + pars['tm']+ "'";
													cdlr=cdlr + ",é¢˜åï¼š"+ pars['tm'];
												}else{
													cx_tj="{tm:'" + pars['tm']+ "'";
													cdlr="é¢˜åï¼š"+ pars['tm'];
												}
											};
											if(pars['ajtm']!=''){
												if (cx_tj!=''){
													cx_tj=cx_tj + ",ajtm:'" + pars['ajtm']+ "'";
													cdlr=cdlr + ",æ¡ˆå·æ ‡é¢˜ï¼š"+ pars['ajtm'];
												}else{
													cx_tj="{ajtm:'" + pars['ajtm']+ "'";
													cdlr="æ¡ˆå·æ ‡é¢˜ï¼š"+ pars['ajtm'];
												}
											};
											if(pars['mlh']!=''){
												if (cx_tj!=''){
													cx_tj=cx_tj + ",mlh:'" + pars['mlh']+ "'";
													cdlr=cdlr +",ç›®å½•å·ï¼š"+ pars['mlh'];
												}else{
													cx_tj="{mlh:'" + pars['mlh']+ "'";
													cdlr="ç›®å½•å·ï¼š"+ pars['mlh'];
												}
											};
											if(pars['ajh']!=''){
												if (cx_tj!=''){
													cx_tj=cx_tj + ",ajh:'" + pars['ajh']+ "'";
													cdlr=cdlr+ ",æ¡ˆå·å·ï¼š"+ pars['ajh'];
												}else{
													cx_tj="{ajh:'" + pars['ajh']+ "'";
													cdlr="æ¡ˆå·å·ï¼š"+ pars['ajh'];
												}
											};
											if(pars['nd']!=''){
												if (cx_tj!=''){
													cx_tj=cx_tj + ",nd:'" + pars['nd']+ "'";
													cdlr=cdlr+ ",å¹´åº¦ï¼š"+ pars['ajh'];
												}else{
													cx_tj="{nd:'" + pars['nd']+ "'";
													cdlr="å¹´åº¦ï¼š"+ pars['nd'];
												}
											};
											if(pars['tdzh']!=''){
												if (cx_tj!=''){
													cx_tj=cx_tj + ",tdzh:'" + pars['tdzh']+ "'";
													cdlr=cdlr+ ",åœŸåœ°è¯å·ï¼š"+ pars['tdzh'];
												}else{
													cx_tj="{tdzh:'" + pars['tdzh']+ "'";
													cdlr="åœŸåœ°è¯å·ï¼š"+ pars['tdzh'];
												}
											};
											if(pars['bz']!=''){
												if (cx_tj!=''){
													cx_tj=cx_tj + ",bz:'" + pars['bz']+ "'";
													cdlr=cdlr+ ",å¤‡æ³¨ï¼š"+ pars['bz'];
												}else{
													cx_tj="{bz:'" + pars['bz']+ "'";
													cdlr="å¤‡æ³¨ï¼š"+ pars['bz'];
												}
											};
											if(pars['dalb']!=undefined){
												if (cx_tj!=''){
													cx_tj=cx_tj + ",dalb:'" + pars['dalb']+ "'";
													cdlr=cdlr+ ",æ¡£æ¡ˆç±»åˆ«ï¼š"+ pars['dalb'];
												}else{
													cx_tj="{dalb:'" + pars['dalb']+ "'";
													cdlr="æ¡£æ¡ˆç±»åˆ«ï¼š"+ pars['dalb'];
												}
											};
											if (cx_tj!=''){
												cx_tj="(" + cx_tj + ",userid:" + currentUser.id + "})";
												var grid = Ext.getCmp('archive_jydj_grid');
												//grid.initialConfig.bbar[0].moveFirst();
												grid.store.proxy.url="/desktop/archive_query_jygl";												
												archive_jydj_store.proxy.extraParams=eval(cx_tj);
												//archive_store.proxy.extraParams=Ext.getCmp('qwjs_form').getValues();
												archive_jydj_store.load();
												Ext.getCmp('cdlr').setValue(cdlr);
											};
											
										}
					
					                },
					                {
					                    xtype: 'label',
					                    height: 20,
					                    width: 65,
					                    text: 'ç›®å½•å·ï¼š',
					                    x: 15,
					                    y: 5
					                },
					                {
					                    xtype: 'label',
					                    height: 20,
					                    text: 'æ–‡      å·ï¼š',
					                    x: 15,
					                    y: 30
					                },
					                {
					                    xtype: 'label',
					                    height: 20,
					                    width: 65,
					                    text: 'æ¡ˆå·å·ï¼š',
					                    x: 210,
					                    y: 5
					                },
					                {
					                    xtype: 'label',
					                    height: 20,
					                    width: 55,
					                    text: 'è´£ä»»è€…ï¼š',
					                    x: 210,
					                    y: 30
					                },
					                {
					                    xtype: 'label',
					                    height: 20,
					                    width: 65,
					                    text: 'æ¡ˆå·æ ‡é¢˜ï¼š',
					                    x: 425,
					                    y: 5
					                },
									{
					                    xtype: 'label',
					                    height: 20,
					                    text: 'æ¡£æ¡ˆç±»åˆ«ï¼š',
					                    x: 695,
					                    y: 5
					                },
									{
					                    xtype: 'combobox',
					                    id: 'dacx_dalb',
										name:'dalb',
					                    width: 140,
					                    fieldLabel: '',
										store: dalb_store_print,
										emptyText:'è¯·é€‰æ‹©',
										mode: 'remote',
										minChars : 2,
										valueField:'id',
										displayField:'lbmc',
										triggerAction:'all',
					                    x: 760,
					                    y: 5
					                },
									{
					                    xtype: 'label',
					                    height: 20,
					                    text: 'å¹´åº¦ï¼š',
					                    x: 695,
					                    y: 30
					                },
									{
						                xtype: 'textfield',
					                    id: 'dacx_nd',

					                    width: 140,
					                    fieldLabel: '',
										name:'nd',
					                    x: 760,
					                    y: 30
					                },
					                {
					                    xtype: 'label',
					                    height: 25,
					                    width: 50,
					                    text: 'é¢˜åï¼š',
					                    x: 425,
					                    y: 30
					                },
					                {
					                    xtype: 'textfield',
					                    id: 'djh',
					
					                    width: 140,
					                    fieldLabel: '',
										name:'djh',
					                    x: 65,
					                    y: 55
					                },
					                {
					                    xtype: 'textfield',
					                    id: 'tdzl',
										name:'tdzl',
					                    width: 145,
					                    fieldLabel: '',
					                    x: 270,
					                    y: 55
					                },
					                {
					                    xtype: 'textfield',
					                    id: 'qlr',
										name:'qlr',
					                    width: 185,
					                    fieldLabel: '',
					                    x: 495,
					                    y: 55
					                },
					                {
					                    xtype: 'label',
					                    height: 20,
					                    text: 'åœ°ç±å·ï¼š',
					                    x: 15,
					                    y: 55
					                },
					                {
					                    xtype: 'label',
					                    height: 20,
					                    width: 60,
					                    text: 'åœŸåœ°åº§è½ï¼š',
					                    x: 210,
					                    y: 55
					                },
					                {
					                    xtype: 'label',
					                    height: 20,
					                    text: 'æƒåˆ©äººåç§°ï¼š',
					                    x: 425,
					                    y: 55
					                },
									
					                {
					                    xtype: 'label',
					                    height: 20,
					                    width: 60,
					                    text: 'åœŸåœ°è¯å·ï¼š',
					                    x: 695,
					                    y: 55
					                },					                																
					                {
					                    xtype: 'textfield',
					                    id: 'dacx_tdzh',
										name:'tdzh',
					                    width: 140,
					                    fieldLabel: '',
					                    x: 760,
					                    y: 55
					                },
									{
					                    xtype: 'label',
					                    height: 20,
					                    width: 60,
					                    text: 'å¤‡æ³¨ï¼š',
					                    x: 15,
					                    y: 80
					                },					                																
					                {
					                    xtype: 'textfield',
					                    id: 'dacx_bz',
										name:'bz',
					                    width: 140,
					                    fieldLabel: '',
					                    x: 65,
					                    y: 80
					                },
									
					            ]}]
		});
		Ext.regModel('jydjlist_dj_model', {
				fields: [
					{name: 'id',		type: 'integer'},
					{name: 'dwdm',		type: 'string'},
					{name: 'dh',		type: 'string'},
					{name: 'qzh',		type: 'string'},
					{name: 'mlh',		type: 'string'},
					{name: 'ajh',		type: 'string'},
					{name: 'tm',		type: 'string'},
					{name: 'flh',		type: 'string'},
					{name: 'nd',		type: 'string'},
					{name: 'qrq',		type: 'date', dateFormat: 'Y-m-d H:i:s'},
					{name: 'zrq',		type: 'date', dateFormat: 'Y-m-d H:i:s'},
					{name: 'js',		type: 'string'},
					{name: 'ys',		type: 'string'},
					{name: 'bgqx',		type: 'string'},
					{name: 'mj',		type: 'string'},
					{name: 'xh',		type: 'string'},
					{name: 'cfwz',		type: 'string'},
					{name: 'bz',		type: 'string'},
					{name: 'boxstr',	type: 'string'},
					{name: 'boxrfid',	type: 'string'},
					{name: 'rfidstr',	type: 'string'},
					{name: 'qny',		type: 'string'},
					{name: 'zny',		type: 'string'},
					{name: 'dalb',		type: 'string'}
				]
		});
			
		var jydjlist_dj_store = Ext.create('Ext.data.Store', {
				id:'jydjlist_dj_store',
				model : 'jydjlist_dj_model',
				//autoload:true,
				proxy: {
					type: 'ajax',
					url : '/desktop/get_archive',
					//extraParams: cx_tj,
					reader: {
						type: 'json',
						root: 'rows',
						totalProperty: 'results'
					}
				}
				//sortInfo:{field: 'level4', direction: "ASC"},
				//baseParams: {start:0, limit:25, query:""}
		});

		var jydjlist_dj_Grid = new Ext.grid.GridPanel({
				id : 'jydjlist_dj_grid',
				store: jydjlist_dj_store,
				
				
				columns: [
					//{ text : 'file_name', flex : 1,	sortable : true, dataIndex: 'level4'},
					//{ text : 'file_size',	 width : 75, sortable : true, dataIndex: 'file_size'}
					{ text : 'id',	width : 0, sortable : true, dataIndex: 'id'},
					{ text : 'dalb',	width : 0, sortable : true, dataIndex: 'dalb'},
					
					{ text : 'å•ä½ä»£ç ',  width : 0, sortable : true, dataIndex: 'dwdm'},
					{ text : 'ç›®å½•å·', width : 75, sortable : true, dataIndex: 'mlh'},
					
					{ text : 'åˆ†ç±»å·',	 width : 75, sortable : true, dataIndex: 'flh'},
					{ text : 'æ¡ˆå·å·',	 width : 75, sortable : true, dataIndex: 'ajh'},
					{ text : 'æ¡ˆå·æ ‡é¢˜',  width : 175, sortable : true, dataIndex: 'tm'},
					
					{ text : 'å¹´åº¦',	width : 75, sortable : true, dataIndex: 'nd'},
					{ text : 'ä»¶æ•°',	width : 75, sortable : true, dataIndex: 'js'},
					{ text : 'é¡µæ•°',	width : 75, sortable : true, dataIndex: 'ys'},
					{ text : 'ä¿ç®¡æœŸé™',  width : 75, sortable : true, dataIndex: 'bgqx'},
					{ text : 'èµ·æ—¥æœŸ',	 width : 0, sortable : true, dataIndex: 'qrq', renderer: Ext.util.Format.dateRenderer('Y-m-d')},
					{ text : 'æ­¢æ—¥æœŸ',	 width : 0, sortable : true, dataIndex: 'zrq', renderer: Ext.util.Format.dateRenderer('Y-m-d')},
					{ text : 'èµ·å¹´æœˆ',	 width : 75, sortable : true, dataIndex: 'qny'},
					{ text : 'æ­¢å¹´æœˆ',	 width : 75, sortable : true, dataIndex: 'zny'},
					{ text : 'æ¡£å·',	width : 75, sortable : true, dataIndex: 'dh'},
					{ text : 'åœ°ç±å·',	 width : 75, sortable : true, dataIndex: 'djh'},
					{ text : 'å¤‡æ³¨',	flex : 1, sortable : true, dataIndex: 'bz'}
					],
					//selType:'checkboxmodel',
					multiSelect:true,
					listeners:{
						itemdblclick:{
							fn:function(v,r,i,n,e,b){
								var tt=r.get("zrq");
								//showContactForm();
								switch (r.data.dalb) { 
				                  case "0": 
				                    DispAj_zh(r,'3',r.data.dh);
				                    break; 
				                  case "2": 
				                    DispAj_cw(r,'3',r.data.dh);
				                    break; 
				                  case "3": 
				                    DispAj_tddj(r,'3',r.data.dh);
				                    break; 
				                  case "24": 
				                    DispAj_wsda(r,'3',r.data.dh);
				                    break;				                 								ã€€ã€€
						          case "15": 
									DispAj_sx(r,'3',r.data.dh);						              
						            break;						          
						          case "5": 
									DispAj_tddj(r,'3',r.data.dh);	
						            break;
						          case "6":
									DispAj_tddj(r,'3',r.data.dh);	 						              
						            break;
						          case "7": 
									DispAj_tddj(r,'3',r.data.dh);							              
						              break;						            
						          case "25":
									DispAj_qtda_dzda(r,'3',r.data.dh);							              
						            break;
						          case "26":
									DispAj_qtda_jjda(r,'3',r.data.dh);
						            break;
						          case "27":
									DispAj_qtda_sbda(r,'3',r.data.dh);
						            break;        
						         ã€€case "28":
									DispAj_qtda_swda(r,'3',r.data.dh);
						            break;
						         ã€€case "29":
									DispAj_qtda_zlxx(r,'3',r.data.dh);
						            break;
						          case "30":
									DispAj_by_tszlhj(r,'3',r.data.dh);
						            break;
						          case "31":
									DispAj_by_tszlhj(r,'3',r.data.dh);
						            break;
						          case "32":
									DispAj_by_zzjgyg(r,'3',r.data.dh);
						            break;
						          case "33":
									DispAj_by_dsj(r,'3',r.data.dh);
						            break;
						          case "34":
									DispAj_by_qzsm(r,'3',r.data.dh);
						            break;
								  case "35":
									DispAj_kyq(r,'3',r.data.dh);
						            break;
						          case "18":
									DispAj_tjml(r,'3',r.data.dh);
						            break;
						          default:
						            DispAj_zh(r,'3',r.data.dh);
						            break;
				                }
								
							}
						}
					},
				viewConfig: {
					stripeRows:true
				}
		});

		Ext.regModel('archive_model', {
				fields: [
					{name: 'id',		type: 'integer'},
					{name: 'dwdm',		type: 'string'},
					{name: 'dh',		type: 'string'},
					{name: 'qzh',		type: 'string'},
					{name: 'mlh',		type: 'string'},
					{name: 'ajh',		type: 'string'},
					{name: 'tm',		type: 'string'},
					{name: 'flh',		type: 'string'},
					{name: 'nd',		type: 'string'},
					{name: 'qrq',		type: 'date', dateFormat: 'Y-m-d H:i:s'},
					{name: 'zrq',		type: 'date', dateFormat: 'Y-m-d H:i:s'},
					{name: 'js',		type: 'string'},
					{name: 'ys',		type: 'string'},
					{name: 'bgqx',		type: 'string'},
					{name: 'mj',		type: 'string'},
					{name: 'xh',		type: 'string'},
					{name: 'cfwz',		type: 'string'},
					{name: 'bz',		type: 'string'},
					{name: 'boxstr',	type: 'string'},
					{name: 'boxrfid',	type: 'string'},
					{name: 'rfidstr',	type: 'string'},
					{name: 'qny',		type: 'string'},
					{name: 'zny',		type: 'string'},
					{name: 'dalb',		type: 'string'}
				]
		});
			
		var archive_jydj_store = Ext.create('Ext.data.Store', {
				id:'archive_jydj_store',
				model : 'archive_model',
				
				proxy: {
					type: 'ajax',
					url : '/desktop/get_archive',
					//extraParams: cx_tj,
					reader: {
						type: 'json',
						root: 'rows',
						totalProperty: 'results'
					}
				}
				//sortInfo:{field: 'level4', direction: "ASC"},
				//baseParams: {start:0, limit:25, query:""}
		});
		function renderDes(value, cellmeta, record, rowIndex, columnIndex, store){
				return "<span style='color:RGB(255, 69, 0);' ext:qtip='" + value + "'>" + value + "</span>";
		};
		var archiveGrid = new Ext.grid.GridPanel({
				id : 'archive_jydj_grid',
				store: archive_jydj_store,
				bbar:[
		          new Ext.PagingToolbar({
		            store: archive_jydj_store,
		            pageSize: 25,
		            width : 700,
		            border : false,
		            displayInfo: true,
		            displayMsg: '{0} - {1} of {2}',
		            emptyMsg: "æ²¡æœ‰æ‰¾åˆ°ï¼",
		            prependButtons: true,
					items : [ {	
						xtype:'button',text:'å¢åŠ è‡³å€Ÿé˜…åˆ—è¡¨',tooltip:'å¢åŠ è‡³å€Ÿé˜…åˆ—è¡¨',id:'add_jylb',iconCls:'add',
						handler: function() {
							var grid = Ext.getCmp('archive_jydj_grid');
							var data=grid.getSelectionModel().getSelection();
							if (data.length==0){
								alert("æ‚¨æœ€å°‘è¦é€‰æ‹©ä¸€æ¡æ¡ˆå·è¿›è¡Œå¤„ç†ã€‚");
							}else{
								var ids=[];
								Ext.Array.each(data,function(record){
									ids.push(record.get("id"));
						
								});
								
								jyajlist=Ext.getCmp('jydjlist_dj_grid').store.data;
								
								//alert(ids);
								Ext.getCmp('jy_aj_list').setValue(ids);
								new Ajax.Request("/desktop/check_jylist", { 
									method: "POST",
									parameters: Ext.getCmp('jydj_form').getValues(),
									onComplete:	 function(request) {
										if (request.responseText=='success'){
											Ext.Array.each(data,function(record){
												sfydj=false;
												for(k=0;k<jyajlist.length;k++){
													if(record.get("id")==jyajlist.items[k].data.id){
														sfydj=true;
													}
												};
												if (sfydj==false){
													var gjcx = Ext.getCmp('jydjlist')													
													gjcx.expand(true);	
													var r = Ext.create('jydjlist_dj_model', {
									                    mlh: record.get("mlh"),
									                    flh: record.get("flh"),
									                    ajh: record.get("ajh"),
														tm: record.get("tm"),
									                    dalb: record.get("dalb"),
									                    qzh: record.get("qzh"),
														id: record.get("id"),
									                    nd: record.get("nd"),
														js: record.get("js"),
									                    bgqx: record.get("bgqx"),
									                    ys: record.get("ys")
									                });
									                jydjlist_dj_store.insert(0, r);
												}
											});
										}else{
											alert(request.responseText);
										}
									}
								});
							}						
						}
					},
					{	
						xtype:'button',text:'ä»å€Ÿé˜…åˆ—è¡¨ä¸­åˆ é™¤',tooltip:'ä»å€Ÿé˜…åˆ—è¡¨ä¸­åˆ é™¤',id:'del_jylb',iconCls:'delete',
						handler: function() {
							var grid = Ext.getCmp('jydjlist_dj_grid');
							var data=grid.getSelectionModel().getSelection();
							if (data.length==0){
								alert("æ‚¨æœ€å°‘è¦é€‰æ‹©ä¸€æ¡æ¡ˆå·è¿›è¡Œåˆ é™¤ã€‚");
							}else{
								jydjlist_dj_store.remove(data);
							}						
						}
					}]
		          })
		        ],
				
				columns: [
					//{ text : 'file_name', flex : 1,	sortable : true, dataIndex: 'level4'},
					//{ text : 'file_size',	 width : 75, sortable : true, dataIndex: 'file_size'}
					{ text : 'id',	width : 0, sortable : true, dataIndex: 'id'},
					{ text : 'dalb',	width : 0, sortable : true, dataIndex: 'dalb'},
					
					{ text : 'å•ä½ä»£ç ',  width : 0, sortable : true, dataIndex: 'dwdm'},
					{ text : 'ç›®å½•å·', width : 75, sortable : true, dataIndex: 'mlh'},
					
					{ text : 'åˆ†ç±»å·',	 width : 75, sortable : true, dataIndex: 'flh'},
					{ text : 'æ¡ˆå·å·',	 width : 75, sortable : true, dataIndex: 'ajh'},
					{ text : 'æ¡ˆå·æ ‡é¢˜',  width : 175, sortable : true, dataIndex: 'tm',
						renderer: function(value,metaData,record,colIndex,store,view) {
									metaData.tdAttr = 'data-qtip="' + value + '"';
						            return value;		
						}					
					},					
					{ text : 'å¹´åº¦',	width : 75, sortable : true, dataIndex: 'nd'},
					{ text : 'ä»¶æ•°',	width : 75, sortable : true, dataIndex: 'js'},
					{ text : 'é¡µæ•°',	width : 75, sortable : true, dataIndex: 'ys'},
					{ text : 'ä¿ç®¡æœŸé™',  width : 75, sortable : true, dataIndex: 'bgqx'},
					{ text : 'èµ·æ—¥æœŸ',	 width : 0, sortable : true, dataIndex: 'qrq', renderer: Ext.util.Format.dateRenderer('Y-m-d')},
					{ text : 'æ­¢æ—¥æœŸ',	 width : 0, sortable : true, dataIndex: 'zrq', renderer: Ext.util.Format.dateRenderer('Y-m-d')},
					{ text : 'èµ·å¹´æœˆ',	 width : 75, sortable : true, dataIndex: 'qny'},
					{ text : 'æ­¢å¹´æœˆ',	 width : 75, sortable : true, dataIndex: 'zny'},
					{ text : 'æ¡£å·',	width : 75, sortable : true, dataIndex: 'dh'},
					{ text : 'åœ°ç±å·',	 width : 75, sortable : true, dataIndex: 'djh'},
					{ text : 'å¤‡æ³¨',	flex : 1, sortable : true, dataIndex: 'bz'}
					],
					selType:'checkboxmodel',
					multiSelect:true,
					listeners:{
						itemdblclick:{
							fn:function(v,r,i,n,e,b){
								var tt=r.get("zrq");
								//showContactForm();
								switch (r.data.dalb) { 
				                  case "0": 
				                    DispAj_zh(r,'3',r.data.dh);
				                    break; 
				                  case "2": 
				                    DispAj_cw(r,'3',r.data.dh);
				                    break; 
				                  case "3": 
				                    DispAj_tddj(r,'3',r.data.dh);
				                    break; 
				                  case "24": 
				                    DispAj_wsda(r,'3',r.data.dh);
				                    break;				                 								ã€€ã€€
						          case "15": 
									DispAj_sx(r,'3',r.data.dh);						              
						            break;						          
						          case "5": 
									DispAj_tddj(r,'3',r.data.dh);	
						            break;
						          case "6":
									DispAj_tddj(r,'3',r.data.dh);	 						              
						            break;
						          case "7": 
									DispAj_tddj(r,'3',r.data.dh);							              
						              break;						            
						          case "25":
									DispAj_qtda_dzda(r,'3',r.data.dh);							              
						            break;
						          case "26":
									DispAj_qtda_jjda(r,'3',r.data.dh);
						            break;
						          case "27":
									DispAj_qtda_sbda(r,'3',r.data.dh);
						            break;        
						         ã€€case "28":
									DispAj_qtda_swda(r,'3',r.data.dh);
						            break;
						         ã€€case "29":
									DispAj_qtda_zlxx(r,'3',r.data.dh);
						            break;
						          case "30":
									DispAj_by_tszlhj(r,'3',r.data.dh);
						            break;
						          case "31":
									DispAj_by_tszlhj(r,'3',r.data.dh);
						            break;
						          case "32":
									DispAj_by_zzjgyg(r,'3',r.data.dh);
						            break;
						          case "33":
									DispAj_by_dsj(r,'3',r.data.dh);
						            break;
						          case "34":
									DispAj_by_qzsm(r,'3',r.data.dh);
						            break;
								  case "35":
									DispAj_kyq(r,'3',r.data.dh);
						            break;
						          case "18":
									DispAj_tjml(r,'3',r.data.dh);
						            break;
						          default:
						            DispAj_zh(r,'3',r.data.dh);
						            break;
				                }
								
							}
						}
					},
				//width : 800,
				//height : 300,
				viewConfig: {
					stripeRows:true
				}
		});
			
			

			
		Ext.regModel('jydjlc_model', {
			fields: [
				{name: 'id',		type: 'integer'},
				{name: 'jyr',		type: 'string'},
				{name: 'jydw',		type: 'string'},
				{name: 'jyqx',		type: 'string'},
				{name: 'lymd',		type: 'string'},
				{name: 'cdlr',		type: 'string'},
				{name: 'jysj',		type: 'date', dateFormat: 'Y-m-d H:i:s'},
				{name: 'jyzt',		type: 'integer'},
				{name: 'jylist',	type: 'string'},
				{name: 'jytj',	type: 'string'},
				{name: 'jylx',	type: 'string'},
				{name: 'hdsj',	type: 'date', dateFormat: 'Y-m-d H:i:s'},
				{name: 'fyys',	type: 'integer'},
				{name: 'zcys',	type: 'integer'},
				{name: 'jyqx',	type: 'integer'},
				{name: 'czrid',	type: 'integer'},
				{name: 'lyxg',	type: 'string'},
				{name: 'zj',	type: 'string'}
			]
		});
		var jydjlc_store = Ext.create('Ext.data.Store', {
				id:'jydjlc_store',
				model : 'jydjlc_model',
				proxy: {
					type: 'ajax',
					url : '/desktop/get_archive',
					extraParams: {query:''},
					reader: {
						type: 'json',
						root: 'rows',
						totalProperty: 'results'
					}
				}
				//sortInfo:{field: 'level4', direction: "ASC"},
				//baseParams: {start:0, limit:25, query:""}
		});
		var jydjlc_grid = new Ext.grid.GridPanel({
				id : 'jydjlc_grid',
				store: jydjlc_store,
				
				
				columns: [
					//{ text : 'file_name', flex : 1,	sortable : true, dataIndex: 'level4'},
					//{ text : 'file_size',	 width : 75, sortable : true, dataIndex: 'file_size'}
					{ text : 'id',	width : 0, sortable : true, dataIndex: 'id'},
					{ text : 'å€Ÿé˜…äºº',	width : 50, sortable : true, dataIndex: 'jyr'},
					{ text : 'å€Ÿé˜…å•ä½',	width : 75, sortable : true, dataIndex: 'jydw'},
					{ text : 'æŸ¥æ¡£å†…å®¹',	width : 75, sortable : true, dataIndex: 'cdlr'},
					{ text : 'å€Ÿé˜…æœŸé™', width : 75, sortable : true, dataIndex: 'jyqx'},
					
					{ text : 'åˆ©ç”¨ç›®çš„',	 width : 75, sortable : true, dataIndex: 'lymd'},
					
					{ text : 'å€Ÿé˜…æ—¶é—´',	 width : 75, sortable : true, dataIndex: 'jysj', renderer: Ext.util.Format.dateRenderer('Y-m-d')},
					{ text : 'jyzt',	 width : 0, sortable : true, dataIndex: 'jyzt'},
					{ text : 'jylist',	 width : 0, sortable : true, dataIndex: 'jylist'},
					{ text : 'jytj',	 width : 0, sortable : true, dataIndex: 'jytj'},
					{ text : 'jylx',	 width : 0, sortable : true, dataIndex: 'jylx'},
					{ text : 'hdsj',	 width : 0, sortable : true, dataIndex: 'hdsj'},
					{ text : 'fyys',	 width : 0, sortable : true, dataIndex: 'fyys'},
					{ text : 'zcys',	 width : 0, sortable : true, dataIndex: 'zcys'},
					{ text : 'jyqx',	 width : 0, sortable : true, dataIndex: 'jyqx'},
					{ text : 'czrid',	 width : 0, sortable : true, dataIndex: 'czrid'},
					{ text : 'lyxg',	 width : 0, sortable : true, dataIndex: 'lyxg'},
					{ text : 'zj',	 width : 0, sortable : true, dataIndex: 'zj'}
				],
				//width : 800,
				//height : 300,
				viewConfig: {
					stripeRows:true
				}
		});
		jydjlc_grid.on("select",function(node){
				data = node.selected.items[0].data;		 // data.id, data.parent, data.text, data.leaf
				archive_id = data.id; 
				if (data.jyzt==2 || data.jyzt==4){
					
					jydjlist_store.proxy.extraParams=eval("({id:" + data.id + ",jyzt:" + data.jyzt + "})");
					jydjlist_store.load();
					var pars={qzid:data.id};
	                  new Ajax.Request("/desktop/get_qz_from_db", {
	                    method: "POST",
	                    parameters: pars,
	                    onComplete:  function(request) {
	                      	var path = request.responseText;
	                      	if (path != '') { 
	                        	Ext.getCmp('preview_img_qz').getEl().dom.src = path;
	                      	}else{
								Ext.getCmp('preview_img_qz').getEl().dom.src = "assets/dady/fm.jpg";
							}
	                    }
	                  });
					
				}else{
					jydjlist_store.proxy.extraParams.query='';
					jydjlist_store.load();
				}
		});
		Ext.regModel('jydjlist_model', {
				fields: [
					{name: 'id',		type: 'integer'},
					{name: 'dwdm',		type: 'string'},
					{name: 'dh',		type: 'string'},
					{name: 'qzh',		type: 'string'},
					{name: 'mlh',		type: 'string'},
					{name: 'ajh',		type: 'string'},
					{name: 'tm',		type: 'string'},
					{name: 'flh',		type: 'string'},
					{name: 'nd',		type: 'string'},
					{name: 'qrq',		type: 'date', dateFormat: 'Y-m-d H:i:s'},
					{name: 'zrq',		type: 'date', dateFormat: 'Y-m-d H:i:s'},
					{name: 'js',		type: 'string'},
					{name: 'ys',		type: 'string'},
					{name: 'bgqx',		type: 'string'},
					{name: 'mj',		type: 'string'},
					{name: 'xh',		type: 'string'},
					{name: 'cfwz',		type: 'string'},
					{name: 'bz',		type: 'string'},
					{name: 'boxstr',	type: 'string'},
					{name: 'boxrfid',	type: 'string'},
					{name: 'rfidstr',	type: 'string'},
					{name: 'qny',		type: 'string'},
					{name: 'zny',		type: 'string'},
					{name: 'dalb',		type: 'string'}
				
				]
		});
		var jydjlist_store = Ext.create('Ext.data.Store', {
				id:'jydjlist_store',
				model : 'jydjlist_model',
				proxy: {
					type: 'ajax',
					url : '/desktop/get_jydjlist',
					extraParams: {query:''},
					reader: {
						type: 'json',
						root: 'rows',
						totalProperty: 'results'
					}
				}
				//sortInfo:{field: 'level4', direction: "ASC"},
				//baseParams: {start:0, limit:25, query:""}
		});
		var jydjlist_grid = new Ext.grid.GridPanel({
				id : 'jydjlist_grid',
				store: jydjlist_store,
				
				
				columns: [
					//{ text : 'file_name', flex : 1,	sortable : true, dataIndex: 'level4'},
					//{ text : 'file_size',	 width : 75, sortable : true, dataIndex: 'file_size'}
					{ text : 'id',	width : 0, sortable : true, dataIndex: 'id'},
					{ text : 'dalb',	width : 0, sortable : true, dataIndex: 'dalb'},
					{ text : 'æ¡£å·',	width : 75, sortable : true, dataIndex: 'dh'},
					{ text : 'ç›®å½•å·', width : 75, sortable : true, dataIndex: 'mlh'},
					
					{ text : 'åˆ†ç±»å·',	 width : 75, sortable : true, dataIndex: 'flh'},
					{ text : 'æ¡ˆå·å·',	 width : 75, sortable : true, dataIndex: 'ajh'},
					{ text : 'æ¡ˆå·æ ‡é¢˜',  width : 175, sortable : true, dataIndex: 'tm'},
					
					{ text : 'å¹´åº¦',	width : 75, sortable : true, dataIndex: 'nd'},
					{ text : 'ä»¶æ•°',	width : 75, sortable : true, dataIndex: 'js'},
					{ text : 'é¡µæ•°',	width : 75, sortable : true, dataIndex: 'ys'},
					{ text : 'ä¿ç®¡æœŸé™',  width : 75, sortable : true, dataIndex: 'bgqx'},
					{ text : 'èµ·æ—¥æœŸ',	 width : 0, sortable : true, dataIndex: 'qrq', renderer: Ext.util.Format.dateRenderer('Y-m-d')},
					{ text : 'æ­¢æ—¥æœŸ',	 width : 0, sortable : true, dataIndex: 'zrq', renderer: Ext.util.Format.dateRenderer('Y-m-d')},
					{ text : 'èµ·å¹´æœˆ',	 width : 75, sortable : true, dataIndex: 'qny'},
					{ text : 'æ­¢å¹´æœˆ',	 width : 75, sortable : true, dataIndex: 'zny'},
					{ text : 'å•ä½ä»£ç ',  width : 75, sortable : true, dataIndex: 'dwdm'},
					{ text : 'åœ°ç±å·',	 width : 75, sortable : true, dataIndex: 'djh'},
					{ text : 'å¤‡æ³¨',	flex : 1, sortable : true, dataIndex: 'bz'}
					
					],
					listeners:{
						itemdblclick:{
							fn:function(v,r,i,n,e,b){
								var tt=r.get("zrq");
								//showContactForm();
								switch (r.data.dalb) { 
				                  case "0": 
				                    DispAj_zh(r,'3',r.data.dh);
				                    break; 
				                  case "2": 
				                    DispAj_cw(r,'3',r.data.dh);
				                    break; 
				                  case "3": 
				                    DispAj_tddj(r,'3',r.data.dh);
				                    break; 
				                  case "24": 
				                    DispAj_wsda(r,'3',r.data.dh);
				                    break;				                 								ã€€ã€€
						          case "15": 
									DispAj_sx(r,'3',r.data.dh);						              
						            break;						          
						          case "5": 
									DispAj_tddj(r,'3',r.data.dh);	
						            break;
						          case "6":
									DispAj_tddj(r,'3',r.data.dh);	 						              
						            break;
						          case "7": 
									DispAj_tddj(r,'3',r.data.dh);							              
						              break;						            
						          case "25":
									DispAj_qtda_dzda(r,'3',r.data.dh);							              
						            break;
						          case "26":
									DispAj_qtda_jjda(r,'3',r.data.dh);
						            break;
						          case "27":
									DispAj_qtda_sbda(r,'3',r.data.dh);
						            break;        
						         ã€€case "28":
									DispAj_qtda_swda(r,'3',r.data.dh);
						            break;
						         ã€€case "29":
									DispAj_qtda_zlxx(r,'3',r.data.dh);
						            break;
						          case "30":
									DispAj_by_tszlhj(r,'3',r.data.dh);
						            break;
						          case "31":
									DispAj_by_tszlhj(r,'3',r.data.dh);
						            break;
						          case "32":
									DispAj_by_zzjgyg(r,'3',r.data.dh);
						            break;
						          case "33":
									DispAj_by_dsj(r,'3',r.data.dh);
						            break;
						          case "34":
									DispAj_by_qzsm(r,'3',r.data.dh);
						            break;
						          case "18":
									DispAj_tjml(r,'3',r.data.dh);
						            break;
						          default:
						            DispAj_zh(r,'3',r.data.dh);
						            break;
				                }
							}
						}
					},
					selType:'checkboxmodel',
					multiSelect:true,
				//width : 800,
				//height : 300,
				viewConfig: {
					stripeRows:true
				}
		});	

		Ext.regModel('zxjydjlc_model', {
			fields: [
				{name: 'id',		type: 'integer'},
				{name: 'ajtm',		type: 'string'},
				{name: 'tm',		type: 'string'},
				{name: 'wh',		type: 'string'},
				{name: 'request_id',		type: 'string'}
				
			]
		});
		var zxjydjlc_store = Ext.create('Ext.data.Store', {
			id:'zxjydjlc_store',
			model : 'zxjydjlc_model',
			autoload:true,
			proxy: {
				type: 'ajax',
				url : '/desktop/get_zxjy',
				extraParams: {query:''},
				reader: {
					type: 'json',
					root: 'rows',
					totalProperty: 'results'
				}
			}
			//sortInfo:{field: 'level4', direction: "ASC"},
			//baseParams: {start:0, limit:25, query:""}
		});
		var zxjydjlc_grid = new Ext.grid.GridPanel({
			id : 'zxjydjlc_grid',
			store: zxjydjlc_store,
			
			
			columns: [
				{ text : 'id',	width : 0, sortable : true, dataIndex: 'id'},
				{ text : 'æ¡ˆå·æ ‡é¢˜',	width : 120, sortable : true, dataIndex: 'ajtm'},
				{ text : 'å·å†…é¢˜å',	width : 120, sortable : true, dataIndex: 'tm'},
				{ text : 'æ–‡å·',	width : 120, sortable : true, dataIndex: 'wh'}					
				],
			viewConfig: {
				stripeRows:true
			}
		});
		zxjydjlc_grid.on("select",function(node){
			data = node.selected.items[0].data;		 // data.id, data.parent, data.text, data.leaf
			archive_id = data.id; 
			zxjyid=data.id;
			cx_tj="";	
			if(data.ajtm!=''){
				if (cx_tj!=''){
					cx_tj=cx_tj + ",ajtm:'" +data.ajtm+ "'";
				}else{
					cx_tj="{ajtm:'" +data.ajtm+ "'";
				}
			};	
			if(data.tm!=''){
				if (cx_tj!=''){
					cx_tj=cx_tj + ",tm:'" +data.tm+ "'";
				}else{
					cx_tj="{tm:'" +data.tm+ "'";
				}
			};
			if(data.wh!=''){
				if (cx_tj!=''){
					cx_tj=cx_tj + ",wh:'" +data.wh+ "'";
				}else{
					cx_tj="{wh:'" +data.wh+ "'";
				}
			};	
			cx_tj="(" + cx_tj + ",userid:" + currentUser.id + "})";		
			
			zxjydjlist_store.proxy.extraParams=eval(cx_tj);
			zxjydjlist_store.load();					
		});
			
		
		var zxjydjlist_store = Ext.create('Ext.data.Store', {
			id:'zxjydjlist_store',
			model : 'jydjlist_model',
			proxy: {
				type: 'ajax',
				url : '/desktop/archive_query_jygl',
				extraParams: {query:''},
				reader: {
					type: 'json',
					root: 'rows',
					totalProperty: 'results'
				}
			}
		});
		var zxjydjlist_grid = new Ext.grid.GridPanel({
			id : 'zxjydjlist_grid',
			store: zxjydjlist_store,				
			columns: [
				{ text : 'id',	width : 0, sortable : true, dataIndex: 'id'},
				{ text : 'dalb',	width : 0, sortable : true, dataIndex: 'dalb'},
				{ text : 'å•ä½ä»£ç ',  width : 0, sortable : true, dataIndex: 'dwdm'},
				{ text : 'ç›®å½•å·', width : 75, sortable : true, dataIndex: 'mlh'},					
				{ text : 'åˆ†ç±»å·',	 width : 75, sortable : true, dataIndex: 'flh'},
				{ text : 'æ¡ˆå·å·',	 width : 75, sortable : true, dataIndex: 'ajh'},
				{ text : 'æ¡ˆå·æ ‡é¢˜',  width : 175, sortable : true, dataIndex: 'tm'},					
				{ text : 'å¹´åº¦',	width : 75, sortable : true, dataIndex: 'nd'},
				{ text : 'ä»¶æ•°',	width : 75, sortable : true, dataIndex: 'js'},
				{ text : 'é¡µæ•°',	width : 75, sortable : true, dataIndex: 'ys'},
				{ text : 'ä¿ç®¡æœŸé™',  width : 75, sortable : true, dataIndex: 'bgqx'},
				{ text : 'èµ·æ—¥æœŸ',	 width : 0, sortable : true, dataIndex: 'qrq', renderer: Ext.util.Format.dateRenderer('Y-m-d')},
				{ text : 'æ­¢æ—¥æœŸ',	 width : 0, sortable : true, dataIndex: 'zrq', renderer: Ext.util.Format.dateRenderer('Y-m-d')},
				{ text : 'èµ·å¹´æœˆ',	 width : 75, sortable : true, dataIndex: 'qny'},
				{ text : 'æ­¢å¹´æœˆ',	 width : 75, sortable : true, dataIndex: 'zny'},
				
				{ text : 'æ¡£å·',	width : 75, sortable : true, dataIndex: 'dh'},
				{ text : 'åœ°ç±å·',	 width : 75, sortable : true, dataIndex: 'djh'},
				{ text : 'å¤‡æ³¨',	flex : 1, sortable : true, dataIndex: 'bz'}					
				],
				listeners:{
					itemdblclick:{
						fn:function(v,r,i,n,e,b){
							var tt=r.get("zrq");
							//showContactForm();
							DispAj(r,false);
						}
					}
				},
				selType:'checkboxmodel',
				multiSelect:true,
			//width : 800,
			//height : 300,
			viewConfig: {
				stripeRows:true
			}
		});
		zxjydjlist_grid.on("select",function(node){
			data = node.selected.items[0].data;
		    timage_store_zxjy.proxy.extraParams = {dh:data.dh, type:'1'};
		    timage_store_zxjy.load();			
		});
		
		var jyqq = function(recordad){
			var js_jyqq_form= new Ext.FormPanel({
					id : 'js_jyqq_form',
					fileUpload: true,
					width: 200,
					height : 100,
					autoHeight: true,
					bodyStyle: 'padding: 5px 5px 5px 5px;',
					labelWidth: 0,
					defaults: {
						anchor: '100%',
						allowBlank: false,
						msgTarget: 'side'
					},
					layout : 'absolute',

					items: [{
						width: 370,
						height: 100,
						xtype:'form',
						border:false,
						layout: 'absolute',
						//id : 'daglaj_form',
						items: [		
						                {
						                    xtype: 'textfield',
						                    id: 'js_jyqq_mlh',
											name:'mlh',
						                    width: 140,
						                    fieldLabel: '',
						                    x: 65,
						                    y: 5
						                },
						                {
						                    xtype: 'textfield',
						                    id: 'js_jyqq_ajh',
											name:'ajh',
						                    width: 145,
						                    fieldLabel: '',
						                    x: 270,
						                    y: 5
						                },
						                {
						                    xtype: 'textfield',
						                    id: 'js_jyqq_ajtm',
											name:'ajtm',
						                    width: 185,
						                    fieldLabel: '',
						                    x: 495,
						                    y: 5
						                },
						                {
						                    xtype: 'textfield',
						                    id: 'js_jyqq_wh',
											name:'wh',
						                    width: 140,
						                    fieldLabel: '',
						                    x: 65,
						                    y: 30
						                },
						                {
						                    xtype: 'textfield',
						                    id: 'js_jyqq_zrz',
											name:'zrz',
						                    width: 145,
						                    fieldLabel: '',
						                    x: 270,
						                    y: 30
						                },
						                {
						                    xtype: 'textfield',
						                    id: 'js_jyqq_tm',
											name:'tm',
						                    width: 185,
						                    fieldLabel: '',
						                    x: 495,
						                    y: 30
						                },
						                {
						                    xtype: 'button',
						                    height: 70,
						                    id: 'js_jyqq_ss',
						                    width: 75,
						                    text: 'è·å–æ¡ä»¶',
						                    x: 690,
						                    y: 5,
											handler: function() {
												var pars=this.up('panel').getForm().getValues();
												//var form = Ext.getCmp('qwjs_form').getForm();
												//pars = form.getValues('tm');
												var cx_tj;
												var cdlr;
												cx_tj='';
												if(pars['djh']!=''){
													cx_tj='{djh:"' + pars['djh'] + '"';
													cdlr="åœ°ç±å·ï¼š"+ pars['djh'];
												};
												if(pars['qlr']!=''){
													if (cx_tj!=''){
														cx_tj=cx_tj + ',qlr:"' + pars['qlr']+ '"';
														cdlr=cdlr + ",æƒåˆ©äººåç§°ï¼š"+ pars['qlr'];
													}else{
														cx_tj='{qlr:"' + pars['qlr']+'"';
														cdlr="æƒåˆ©äººåç§°ï¼š"+ pars['qlr'];
													}
												};
												if(pars['tdzl']!=''){
													if (cx_tj!=''){
														cx_tj=cx_tj + ',tdzl:"' + pars['tdzl']+ '"';
														cdlr=cdlr + ",åœŸåœ°åº§è½ï¼š"+ pars['tdzl'];
													}else{
														cx_tj='{tdzl:"' + pars['tdzl']+ '"';
														cdlr="åœŸåœ°åº§è½ï¼š"+ pars['tdzl'];
													}
												};
												if(pars['zrz']!=''){
													if (cx_tj!=''){
														cx_tj=cx_tj + ',zrz:"' + pars['rzr']+ '"';
														cdlr=cdlr + ",è´£ä»»è€…ï¼š"+ pars['rzr'];
													}else{
														cx_tj='{rzr:"' + pars['zrz']+ '"';
														cdlr="è´£ä»»è€…ï¼š"+ pars['rzr'];
													}
												};
												if(pars['wh']!=''){
													if (cx_tj!=''){
														cx_tj=cx_tj + ',wh:"' + pars['wh']+ '"';
														cdlr=cdlr + ",æ–‡å·ï¼š"+ pars['wh'];
													}else{
														cx_tj='{wh:"' + pars['wh']+ '"';
														cdlr="æ–‡å·ï¼š"+ pars['wh'];
													}
												};
												if(pars['tm']!=''){
													if (cx_tj!=''){
														cx_tj=cx_tj + ',tm:"' + pars['tm']+ '"';
														cdlr=cdlr + ",é¢˜åï¼š"+ pars['tm'];
													}else{
														cx_tj='{tm:"' + pars['tm']+ '"';
														cdlr="é¢˜åï¼š"+ pars['tm']+ "";
													}
												};
												if(pars['ajtm']!=''){
													if (cx_tj!=''){
														cx_tj=cx_tj + ',ajtm:"' + pars['ajtm']+ '"';
														cdlr=cdlr + ",æ¡ˆå·æ ‡é¢˜ï¼š"+ pars['ajtm'];
													}else{
														cx_tj='{ajtm:"' + pars['ajtm']+ '"';
														cdlr='æ¡ˆå·æ ‡é¢˜ï¼š"'+ pars['ajtm']+ '"';
													}
												};
												if(pars['mlh']!=''){
													if (cx_tj!=''){
														cx_tj=cx_tj + ',mlh:"' + pars['mlh']+ '"';
														cdlr=cdlr +",ç›®å½•å·ï¼š"+ pars['mlh'];
													}else{
														cx_tj='{mlh:"' + pars['mlh']+ '"';
														cdlr="ç›®å½•å·ï¼š"+ pars['mlh'];
													}
												};
												if(pars['ajh']!=''){
													if (cx_tj!=''){
														cx_tj=cx_tj + ',ajh:"' + pars['ajh']+ '"';
														cdlr=cdlr+ ",æ¡ˆå·å·ï¼š"+ pars['ajh'];
													}else{
														cx_tj='{ajh:"' + pars['ajh']+ '"';
														cdlr="æ¡ˆå·å·ï¼š"+ pars['ajh'];
													}
												};
												if (cx_tj!=''){
													cx_tj="(" + cx_tj + "})";
													//cx_tj="(" + cx_tj + ",userid:" + currentUser.id + "})";
													//var grid = Ext.getCmp('archive_grid');
													//grid.store.proxy.url="/desktop/archive_query_jygl";

													//archive_store.proxy.extraParams=eval(cx_tj);
													//archive_store.proxy.extraParams=Ext.getCmp('qwjs_form').getValues();
													//archive_store.load();
													Ext.getCmp('js_jyqq_jytj').setValue(cx_tj);
													Ext.getCmp('jydj_jyqq_cdlr').setValue(cdlr);
												};

											}

						                },
						                {
						                    xtype: 'label',
						                    height: 20,
						                    width: 65,
						                    text: 'ç›®å½•å·ï¼š',
						                    x: 15,
						                    y: 5
						                },
						                {
						                    xtype: 'label',
						                    height: 20,
						                    text: 'æ–‡      å·ï¼š',
						                    x: 15,
						                    y: 30
						                },
						                {
						                    xtype: 'label',
						                    height: 20,
						                    width: 65,
						                    text: 'æ¡ˆå·å·ï¼š',
						                    x: 210,
						                    y: 5
						                },
						                {
						                    xtype: 'label',
						                    height: 20,
						                    width: 55,
						                    text: 'è´£ä»»è€…ï¼š',
						                    x: 210,
						                    y: 30
						                },
						                {
						                    xtype: 'label',
						                    height: 20,
						                    width: 65,
						                    text: 'æ¡ˆå·æ ‡é¢˜ï¼š',
						                    x: 425,
						                    y: 5
						                },
						                {
						                    xtype: 'label',
						                    height: 25,
						                    width: 50,
						                    text: 'é¢˜åï¼š',
						                    x: 425,
						                    y: 30
						                },
						                {
						                    xtype: 'textfield',
						                    id: 'js_jyqq_djh',

						                    width: 140,
						                    fieldLabel: '',
											name:'djh',
						                    x: 65,
						                    y: 55
						                },
						                {
						                    xtype: 'textfield',
						                    id: 'js_jyqq_tdzl',
											name:'tdzl',
						                    width: 145,
						                    fieldLabel: '',
						                    x: 270,
						                    y: 55
						                },
						                {
						                    xtype: 'textfield',
						                    id: 'js_jyqq_qlr',
											name:'qlr',
						                    width: 185,
						                    fieldLabel: '',
						                    x: 495,
						                    y: 55
						                },
						                {
						                    xtype: 'label',
						                    height: 20,
						                    text: 'åœ°ç±å·ï¼š',
						                    x: 15,
						                    y: 55
						                },
						                {
						                    xtype: 'label',
						                    height: 20,
						                    width: 60,
						                    text: 'åœŸåœ°åº§è½ï¼š',
						                    x: 210,
						                    y: 55
						                },
						                {
						                    xtype: 'label',
						                    height: 20,
						                    text: 'æƒåˆ©äººåç§°ï¼š',
						                    x: 425,
						                    y: 55
						                }
						            ]}]
			});
			var jydj_jyqq_form= new Ext.FormPanel({
							id : 'jydj_jyqq_form',
							fileUpload: true,
							width: 200,
							height : 180,
							autoHeight: true,
							bodyStyle: 'padding: 5px 5px 5px 5px;',
							labelWidth: 0,
							defaults: {
								anchor: '100%',
								allowBlank: false,
								msgTarget: 'side'
							},
							layout : 'absolute',
							tbar:[							  
								{	
									xtype:'button',text:'å€Ÿé˜…ç”³è¯·',tooltip:'å€Ÿé˜…ç”³è¯·',id:'jyqq_sq',iconCls:'tyqq',
									handler: function() {

										Ext.getCmp('jydj_jyqq_jyzt').setValue('1');
										if (jyqq_add_change=='1'){


														new Ajax.Request("/desktop/insert_jylc", { 
															method: "POST",
															parameters: Ext.getCmp('jydj_jyqq_form').getValues(),
															onComplete:	 function(request) {
																if (request.responseText=='success'){

																	alert("ç”³è¯·æˆåŠŸã€‚");
																	Ext.getCmp('jyqq_win').close();
																	var grid = Ext.getCmp('jydjlc_grid');
																	grid.store.proxy.url="/desktop/get_jydjlc_jyzt";
																	jydjlc_store.proxy.extraParams=eval("({userid:" + currentUser.id + ",jyzt:" + jydj_jyzt + "})");
																	jydjlc_store.load();
																}else{
																	alert("ç”³è¯·å¤±è´¥ï¼Œè¯·é‡æ–°ç”³è¯·ã€‚");
																}
															}
														});



										}else
										{
											new Ajax.Request("/desktop/update_jylc", { 
												method: "POST",
												parameters: Ext.getCmp('jydj_jyqq_form').getValues(),
												onComplete:	 function(request) {
													if (request.responseText=='success'){
														alert("ä¿®æ”¹æˆåŠŸã€‚");
														Ext.getCmp('jyqq_win').close();
														var grid = Ext.getCmp('jydjlc_grid');
														grid.store.proxy.url="/desktop/get_jydjlc_jyzt";
														jydjlc_store.proxy.extraParams=eval("({userid:" + currentUser.id + ",jyzt:" + jydj_jyzt + "})");
														jydjlc_store.load();
													}else{
														alert("ä¿®æ”¹å¤±è´¥ï¼Œè¯·é‡æ–°ä¿®æ”¹ã€‚");
													}
												}
											});
										}
									}
								},
								{	
									xtype:'button',text:'é€€å‡º',tooltip:'é€€å‡º',id:'jyqq_tc',iconCls:'exit',


										handler: function() {

												Ext.getCmp('jyqq_win').close();

											}


								}

							],
							items: [{
								width: 370,
								height: 180,
								xtype:'form',
								border:false,
								layout: 'absolute',
								//id : 'jydj_form',
								items: [		{
													xtype:'textfield',
													width:300,
													hidden:true,
													name:'id',
													id:'js_jyqq_id',

												},
												{
													xtype:'textfield',
													width:300,
													hidden:true,
													name:'jytj',
													id:'js_jyqq_jytj',

												},	
												{
													xtype: 'textfield',
													hidden : true,
													name : 'jyzt' ,
													id:'jydj_jyqq_jyzt'										
												},
												{
													xtype: 'textfield',
													hidden : true,
													name : 'czrid' ,
													id:'jydj_jyqq_czrid'										
												},
												{
													xtype: 'textfield',
													hidden : true,
													name : 'jy_aj_list' ,
													id:'jydj_jyqq_jy_aj_list'										
												},
								                {
								                    xtype: 'textfield',
								                    name: 'jyr',
								                    fieldLabel: '',
													id:'jydj_jyqq_jyr',
								                    x: 75,
								                    y: 5
								                },
								                {
								                    xtype: 'textfield',
								                    name: 'jydw',
													id:'jydj_jyqq_jydw',
								                    width: 465,
								                    fieldLabel: '',
								                    x: 295,
								                    y: 5
								                },
								                {
								                    xtype: 'textfield',
								                    name: 'fyys',
													id:'jydj_jyqq_fyys',
								                    fieldLabel: '',
								                    x: 75,
								                    y: 105
								                },
								                {
								                    xtype: 'textfield',
								                    name: 'zj',
													id:'jydj_jyqq_zj',
								                    width: 465,
								                    fieldLabel: '',
								                    x: 295,
								                    y: 30
								                },
								                {
								                    xtype: 'combobox',
								                    name: 'jylx',
								                    store: jydj_jylx_store,
													emptyText:'è¯·é€‰æ‹©',
													mode: 'remote',
													minChars : 2,
													valueField:'text',
													displayField:'text',
													triggerAction:'all',
								                    x: 75,
								                    y: 30
								                },
								                {
								                    xtype: 'combobox',
								                    name: 'lymd',
								                    store: jydj_lymd_store,
													emptyText:'è¯·é€‰æ‹©',
													mode: 'remote',
													minChars : 2,
													valueField:'text',
													displayField:'text',
													triggerAction:'all',
								                    x: 75,
								                    y: 55
								                },
								                {
								                    xtype: 'textfield',
								                    name: 'cdlr',
													id:'jydj_jyqq_cdlr',
								                    width: 465,
								                    fieldLabel: '',
								                    x: 295,
								                    y: 80
								                },
								                {
								                    xtype: 'textfield',
								                    name: 'lyxg',
								                    width: 465,
								                    fieldLabel: '',
								                    x: 295,
								                    y: 55
								                },
								                {
								                    xtype: 'label',
								                    height: 20,
								                    width: 55,
								                    text: 'å€Ÿé˜…äººï¼š',
								                    x: 15,
								                    y: 5
								                },
								                {
								                    xtype: 'label',
								                    height: 20,
								                    width: 65,
								                    text: 'å€Ÿé˜…å•ä½ï¼š',
								                    x: 230,
								                    y: 5
								                },
								                {
								                    xtype: 'combobox',
								                    name: 'jyqx',
								                    store: jydj_jyqx_store,
													emptyText:'è¯·é€‰æ‹©',
													mode: 'remote',
													minChars : 2,
													valueField:'value',
													displayField:'text',
													triggerAction:'all',
								                    x: 75,
								                    y: 80
								                },
								                {
								                    xtype: 'label',
								                    height: 25,
								                    width: 65,
								                    text: 'å€Ÿé˜…ç±»å‹ï¼š',
								                    x: 15,
								                    y: 30
								                },
								                {
								                    xtype: 'label',
								                    height: 20,
								                    width: 65,
								                    text: 'åˆ©ç”¨ç›®çš„ï¼š',
								                    x: 15,
								                    y: 55
								                },
								                {
								                    xtype: 'label',
								                    height: 20,
								                    width: 70,
								                    text: 'å€Ÿé˜…æœŸé™ï¼š',
								                    x: 15,
								                    y: 80
								                },
								                {
								                    xtype: 'label',
								                    height: 25,
								                    width: 60,
								                    text: 'è¯ä»¶ï¼š',
								                    x: 230,
								                    y: 30
								                },
								                {
								                    xtype: 'label',
								                    height: 25,
								                    width: 60,
								                    text: 'æŸ¥æ¡£å†…å®¹ï¼š',
								                    x: 230,
								                    y: 80
								                },
								                {
								                    xtype: 'label',
								                    height: 25,
								                    width: 65,
								                    text: 'åˆ©ç”¨æ•ˆæœï¼š',
								                    x: 230,
								                    y: 55
								                },
								                {
								                    xtype: 'label',
								                    height: 25,
								                    width: 65,
								                    text: 'å¤å°é¡µæ•°ï¼š',
								                    x: 15,
								                    y: 105
								                },
								                {
								                    xtype: 'label',
								                    height: 20,
								                    width: 65,
								                    text: 'æ‘˜æŠ„é¡µæ•°ï¼š',
								                    x: 230,
								                    y: 105
								                },
								                {
								                    xtype: 'label',
								                    height: 20,
								                    width: 55,
								                    text: 'å¤‡æ³¨ï¼š',
								                    x: 455,
								                    y: 110
								                },
								                {
								                    xtype: 'textfield',
								                    name: 'zcys',
								                    fieldLabel: '',
								                    x: 295,
								                    y: 105
								                },
								                {
								                    xtype: 'textfield',
								                    name: 'bz',
								                    width: 260,
								                    fieldLabel: '',
								                    x: 500,
								                    y: 105
								                }
								            ]}],

			});
			var win = Ext.getCmp('jyqq_win');
				
			if (win==undefined) {
				win = new Ext.Window({
					id : 'jyqq_win',
					title: 'å€Ÿé˜…è¯·æ±‚',
					iconCls:'jyqq',
					layout: 'border',
					modal: true,
					width:800,
		            height:320,
					items:[{
							
							region: 'north',
							height: 100,
							layout: 'fit',
							

							items: js_jyqq_form
						},

						{
							region: 'center',
							//iconCls:'icon-grid',
							
							layout: 'fit',
							height: 180,
							//split: true,
							//collapseMode:'mini',
							//collapsible: true,
							//title: '',
							//hideCollapseTool:true,
							items:jydj_jyqq_form

						}]
				
				
				
				})
					//closeAction: 'hide',
					
			}
			if (jyqq_add_change==2){
				Ext.getCmp('jyqq_sq').text="ä¿®æ”¹ç”³è¯·";
				Ext.getCmp('jyqq_win').title="ä¿®æ”¹è¯·æ±‚";
				Ext.getCmp('jyqq_win').iconCls="xgqq";
				Ext.getCmp('jydj_jyqq_form').getForm().setValues(recordad.data);
			}else{
				Ext.getCmp('jydj_jyqq_czrid').setValue(currentUser.id);
				Ext.getCmp('jyqq_sq').text="ç¡®å®šç”³è¯·";
			}
			win.show();
		};	

		var clqq = function(recordad){
			Ext.regModel('jydj_clqq_model', {
				fields: [
					{name: 'id',		type: 'integer'},
					{name: 'dwdm',		type: 'string'},
					{name: 'dh',		type: 'string'},
					{name: 'qzh',		type: 'string'},
					{name: 'mlh',		type: 'string'},
					{name: 'ajh',		type: 'string'},
					{name: 'tm',		type: 'string'},
					{name: 'flh',		type: 'string'},
					{name: 'nd',		type: 'string'},
					{name: 'qrq',		type: 'date', dateFormat: 'Y-m-d H:i:s'},
					{name: 'zrq',		type: 'date', dateFormat: 'Y-m-d H:i:s'},
					{name: 'js',		type: 'string'},
					{name: 'ys',		type: 'string'},
					{name: 'bgqx',		type: 'string'},
					{name: 'mj',		type: 'string'},
					{name: 'xh',		type: 'string'},
					{name: 'cfwz',		type: 'string'},
					{name: 'bz',		type: 'string'},
					{name: 'boxstr',	type: 'string'},
					{name: 'boxrfid',	type: 'string'},
					{name: 'rfidstr',	type: 'string'},
					{name: 'qny',		type: 'string'},
					{name: 'zny',		type: 'string'},
					{name: 'dalb',		type: 'string'}

				]
			});
			var jydj_clqq_store = Ext.create('Ext.data.Store', {
				id:'jydj_clqq_store',
				model : 'jydj_clqq_model',
				proxy: {
					type: 'ajax',
					url : '/desktop/get_jydjlist',
					extraParams: {query:''},
					reader: {
						type: 'json',
						root: 'rows',
						totalProperty: 'results'
					}
				}
				//sortInfo:{field: 'level4', direction: "ASC"},
				//baseParams: {start:0, limit:25, query:""}
			});
			var jydj_clqq_grid = new Ext.grid.GridPanel({
				id : 'jydj_clqq_grid',
				store: jydj_clqq_store,


				columns: [
					//{ text : 'file_name', flex : 1,	sortable : true, dataIndex: 'level4'},
					//{ text : 'file_size',	 width : 75, sortable : true, dataIndex: 'file_size'}
					{ text : 'id',	width : 0, sortable : true, dataIndex: 'id'},
					{ text : 'dalb',	width : 0, sortable : true, dataIndex: 'dalb'},
					
					{ text : 'å•ä½ä»£ç ',  width : 0, sortable : true, dataIndex: 'dwdm'},
					{ text : 'ç›®å½•å·', width : 75, sortable : true, dataIndex: 'mlh'},

					{ text : 'åˆ†ç±»å·',	 width : 75, sortable : true, dataIndex: 'flh'},
					{ text : 'æ¡ˆå·å·',	 width : 75, sortable : true, dataIndex: 'ajh'},
					{ text : 'æ¡ˆå·æ ‡é¢˜',  width : 175, sortable : true, dataIndex: 'tm'},

					{ text : 'å¹´åº¦',	width : 75, sortable : true, dataIndex: 'nd'},
					{ text : 'ä»¶æ•°',	width : 75, sortable : true, dataIndex: 'js'},
					{ text : 'é¡µæ•°',	width : 75, sortable : true, dataIndex: 'ys'},
					{ text : 'ä¿ç®¡æœŸé™',  width : 75, sortable : true, dataIndex: 'bgqx'},
					{ text : 'èµ·æ—¥æœŸ',	 width : 0, sortable : true, dataIndex: 'qrq', renderer: Ext.util.Format.dateRenderer('Y-m-d')},
					{ text : 'æ­¢æ—¥æœŸ',	 width : 0, sortable : true, dataIndex: 'zrq', renderer: Ext.util.Format.dateRenderer('Y-m-d')},
					{ text : 'èµ·å¹´æœˆ',	 width : 75, sortable : true, dataIndex: 'qny'},
					{ text : 'æ­¢å¹´æœˆ',	 width : 75, sortable : true, dataIndex: 'zny'},
					{ text : 'æ¡£å·',	width : 75, sortable : true, dataIndex: 'dh'},
					{ text : 'åœ°ç±å·',	 width : 75, sortable : true, dataIndex: 'djh'},
					{ text : 'å¤‡æ³¨',	flex : 1, sortable : true, dataIndex: 'bz'}

					],
					selType:'checkboxmodel',
					multiSelect:true,
					listeners:{
						itemdblclick:{
							fn:function(v,r,i,n,e,b){
								var tt=r.get("zrq");
								//showContactForm();
								DispAj(r,false);
							}
						}
					},
				//width : 800,
				//height : 300,
				viewConfig: {
					stripeRows:true
				}
			});
			var jydj_clqq_form= new Ext.FormPanel({
					id : 'jydj_clqq_form',
					fileUpload: true,
					width: 850,
					height : 180,
					autoHeight: true,
					bodyStyle: 'padding: 5px 5px 5px 5px;',
					labelWidth: 0,
					defaults: {
						anchor: '100%',
						allowBlank: false,
						msgTarget: 'side'
					},
					layout : 'absolute',
					tbar:[							  
						{	
							xtype:'button',text:'åŒæ„',tooltip:'åŒæ„',id:'clqq_ty',iconCls:'tyqq',
							handler: function() {
								var grid = Ext.getCmp('jydj_clqq_grid');
								var data=grid.getSelectionModel().getSelection();
								//alert(data.length);
								if (data.length==0){
									alert("æ‚¨æœ€å°‘è¦é€‰æ‹©ä¸€æ¡æ¡ˆå·è¿›è¡Œå¤„ç†ã€‚");
								}else{
									var ids=[];
									Ext.Array.each(data,function(record){
										ids.push(record.get("id"));

									});
									Ext.getCmp('jydj_clqq_jyzt').setValue('2');
									Ext.getCmp('jydj_clqq_jy_aj_list').setValue(ids);
									new Ajax.Request("/desktop/check_jylist", { 
										method: "POST",
										parameters: Ext.getCmp('jydj_clqq_form').getValues(),
										onComplete:	 function(request) {
											if (request.responseText=='success'){
												new Ajax.Request("/desktop/update_jylc", { 
													method: "POST",
													parameters: Ext.getCmp('jydj_clqq_form').getValues(),
													onComplete:	 function(request) {
														if (request.responseText=='success'){
															alert("å€Ÿé˜…ç”³è¯·å¤„ç†æˆåŠŸã€‚");
															Ext.getCmp('clqq_win').close();
															var grid = Ext.getCmp('jydjlc_grid');
															grid.store.proxy.url="/desktop/get_jydjlc_jyzt";
															jydjlc_store.proxy.extraParams=eval("({userid:" + currentUser.id + ",jyzt:" + jydj_jyzt + "})");
															jydjlc_store.load();
														}else{
															alert("å€Ÿé˜…ç”³è¯·å¤„ç†å¤±è´¥ï¼Œè¯·é‡æ–°å¤„ç†ã€‚");
														}
													}
												});
											}else{
												alert("å€Ÿé˜…ç”³è¯·å¤„ç†å¤±è´¥ï¼Œè¯·é‡æ–°å¤„ç†ã€‚");
											}
										}
									});


								}
							}
						},
						{	
							xtype:'button',text:'æ‰“å›',tooltip:'æ‰“å›',id:'clqq_dh',iconCls:'dh',


								handler: function() {
									Ext.getCmp('jydj_clqq_jyzt').setValue('3');

									new Ajax.Request("/desktop/update_jylc", { 
										method: "POST",
										parameters: Ext.getCmp('jydj_clqq_form').getValues(),
										onComplete:	 function(request) {
											if (request.responseText=='success'){
												alert("æ‰“å›æˆåŠŸã€‚");
												Ext.getCmp('clqq_win').close();
												var grid = Ext.getCmp('jydjlc_grid');
												grid.store.proxy.url="/desktop/get_jydjlc_jyzt";
												jydjlc_store.proxy.extraParams=eval("({userid:" + currentUser.id + ",jyzt:1})");;
												jydjlc_store.load();
											}else{
												alert("æ‰“å›å¤±è´¥ï¼Œè¯·é‡æ–°æ‰“å›ã€‚");
											}
										}
									});

								}							

						},
						{	
							xtype:'button',text:'é€€å‡º',tooltip:'é€€å‡º',id:'clqq_tc',iconCls:'exit',
							handler: function() {
								Ext.getCmp('clqq_win').close();
							}
						}
					],
					items: [{
						width: 850,
						height: 180,
						xtype:'form',
						border:false,
						layout: 'absolute',
						//id : 'jydj_form',
						items: [		
									{
										xtype: 'textfield',
										hidden : true,
										name : 'id' ,
										id:'jydj_clqq_id'										
									},{
										xtype: 'textfield',
										hidden : true,
										name : 'jytj' ,
										id:'jydj_clqq_jytj'										
									},{
										xtype: 'textfield',
										hidden : true,
										name : 'jyzt' ,
										id:'jydj_clqq_jyzt'										
									},
									{
										xtype: 'textfield',
										hidden : true,
										name : 'czrid' ,
										id:'jydj_clqq_czrid'										
									},
									{
										xtype: 'textfield',
										hidden : true,
										name : 'jy_aj_list' ,
										id:'jydj_clqq_jy_aj_list'										
									},
					                {
					                    xtype: 'textfield',
					                    name: 'jyr',
					                    fieldLabel: '',
					                    x: 75,
					                    y: 5
					                },
					                {
					                    xtype: 'textfield',
					                    name: 'jydw',
					                    width: 465,
					                    fieldLabel: '',
					                    x: 295,
					                    y: 5
					                },
					                {
					                    xtype: 'textfield',
					                    name: 'fyys',
					                    fieldLabel: '',
					                    x: 75,
					                    y: 105
					                },
					                {
					                    xtype: 'textfield',
					                    name: 'zj',
					                    width: 465,
					                    fieldLabel: '',
					                    x: 295,
					                    y: 30
					                },
					                {
					                    xtype: 'combobox',
					                    name: 'jylx',
					                    store: jydj_jylx_store,
										emptyText:'è¯·é€‰æ‹©',
										mode: 'remote',
										minChars : 2,
										valueField:'text',
										displayField:'text',
										triggerAction:'all',
					                    x: 75,
					                    y: 30
					                },
					                {
					                    xtype: 'combobox',
					                    name: 'lymd',
					                    store: jydj_lymd_store,
										emptyText:'è¯·é€‰æ‹©',
										mode: 'remote',
										minChars : 2,
										valueField:'text',
										displayField:'text',
										triggerAction:'all',
					                    x: 75,
					                    y: 55
					                },
					                {
					                    xtype: 'textfield',
					                    name: 'cdlr',
										id:'jydj_clqq_cdlr',
					                    width: 465,
					                    fieldLabel: '',
					                    x: 295,
					                    y: 80
					                },
					                {
					                    xtype: 'textfield',
					                    name: 'lyxg',
					                    width: 465,
					                    fieldLabel: '',
					                    x: 295,
					                    y: 55
					                },
					                {
					                    xtype: 'label',
					                    height: 20,
					                    width: 55,
					                    text: 'å€Ÿé˜…äººï¼š',
					                    x: 15,
					                    y: 5
					                },
					                {
					                    xtype: 'label',
					                    height: 20,
					                    width: 65,
					                    text: 'å€Ÿé˜…å•ä½ï¼š',
					                    x: 230,
					                    y: 5
					                },
					                {
					                    xtype: 'combobox',
					                    name: 'jyqx',
					                    store: jydj_jyqx_store,
										emptyText:'è¯·é€‰æ‹©',
										mode: 'remote',
										minChars : 2,
										valueField:'value',
										displayField:'text',
										triggerAction:'all',
					                    x: 75,
					                    y: 80
					                },
					                {
					                    xtype: 'label',
					                    height: 25,
					                    width: 65,
					                    text: 'å€Ÿé˜…ç±»å‹ï¼š',
					                    x: 15,
					                    y: 30
					                },
					                {
					                    xtype: 'label',
					                    height: 20,
					                    width: 65,
					                    text: 'åˆ©ç”¨ç›®çš„ï¼š',
					                    x: 15,
					                    y: 55
					                },
					                {
					                    xtype: 'label',
					                    height: 20,
					                    width: 70,
					                    text: 'å€Ÿé˜…æœŸé™ï¼š',
					                    x: 15,
					                    y: 80
					                },
					                {
					                    xtype: 'label',
					                    height: 25,
					                    width: 60,
					                    text: 'è¯ä»¶ï¼š',
					                    x: 230,
					                    y: 30
					                },
					                {
					                    xtype: 'label',
					                    height: 25,
					                    width: 60,
					                    text: 'æŸ¥æ¡£å†…å®¹ï¼š',
					                    x: 230,
					                    y: 80
					                },
					                {
					                    xtype: 'label',
					                    height: 25,
					                    width: 65,
					                    text: 'åˆ©ç”¨æ•ˆæœï¼š',
					                    x: 230,
					                    y: 55
					                },
					                {
					                    xtype: 'label',
					                    height: 25,
					                    width: 65,
					                    text: 'å¤å°é¡µæ•°ï¼š',
					                    x: 15,
					                    y: 105
					                },
					                {
					                    xtype: 'label',
					                    height: 20,
					                    width: 65,
					                    text: 'æ‘˜æŠ„é¡µæ•°ï¼š',
					                    x: 230,
					                    y: 105
					                },
					                {
					                    xtype: 'label',
					                    height: 20,
					                    width: 55,
					                    text: 'å¤‡æ³¨ï¼š',
					                    x: 455,
					                    y: 110
					                },
					                {
					                    xtype: 'textfield',
					                    name: 'zcys',
					                    fieldLabel: '',
					                    x: 295,
					                    y: 105
					                },
					                {
					                    xtype: 'textfield',
					                    name: 'bz',
					                    width: 260,
					                    fieldLabel: '',
					                    x: 500,
					                    y: 105
					                }
						]
					}],

			});
			var win = Ext.getCmp('clqq_win');
			if (win==null) {
				win = new Ext.Window({
					id : 'clqq_win',
					title: 'å¤„ç†è¯·æ±‚',
					modal: true,
					iconCls:'clqq',
					layout: 'border',
					width:800,
		            height:400,
					items:[
						{
							
							region: 'north',
							height: 30,
							layout: 'fit',
							tbar:[				
								'&nbsp;&nbsp;<span style=" font-size:12px;font-weight:600;color:#3366FF;">æŸ¥æ¡£å†…å®¹</span>:&nbsp;&nbsp;',
								{
									xtype:'textfield',
									width:300,
									id:'clqq_query_text',

								},				  
								{	
									xtype:'button',text:'æ£€ç´¢',tooltip:'æ£€ç´¢',id:'clqq_query',iconCls:'search',
									handler: function() {
										var grid = Ext.getCmp('jydj_clqq_grid');
										grid.store.proxy.url="/desktop/archive_query_jygl";
										grid.store.proxy.extraParams=eval(Ext.getCmp('clqq_query_text').value);											
										grid.store.load();
									}
								}]
						
						},
						{
							region:'center',
							//height: 100,
							layout: 'fit',
							items:jydj_clqq_grid
						},{
							region: 'south',
							//iconCls:'icon-grid',							
							layout: 'fit',
							height: 180,							
							items:jydj_clqq_form
						}]				
				})
					//closeAction: 'hide',					
			}
			Ext.getCmp('jydj_clqq_form').getForm().setValues(recordad.data);
			Ext.getCmp('clqq_query_text').setValue(recordad.data.jytj);
			Ext.getCmp('jydj_clqq_jytj').setValue(recordad.data.jytj);
			//Ext.getCmp('jr_ownerid').setValue(recordad.data.id);			
			win.show();
		};			
		var timage_store_zxjy	= Ext.create('Ext.data.TreeStore', {
			//autoLoad: true,
			proxy: {
					type: 'ajax',
					url : '/desktop/get_timage_tree',
			        //extraParams: {dh:"",type:"0"},
					actionMethods: 'POST'
			}
		});
			
		var image_tree1 = Ext.create('Ext.tree.Panel', {
			id : 'image_tree1',
			store: timage_store_zxjy,
			rootVisible:false,
			useArrows: true,
			listeners:{
				checkchange:function(node,checked,option){
					if(checked){
						var pars={gid:node.data.id, type:0};
		                  new Ajax.Request("/desktop/get_timage_from_db", {
		                    method: "POST",
		                    parameters: pars,
		                    onComplete:  function(request) {
		                      var path = request.responseText;
		                      if (path != '') { 
		                        Ext.getCmp('preview_img').getEl().dom.src = path;
		                      }
		                    }
		                  });
					}

				}
			}
		});
		    
		var tabPanel = new Ext.TabPanel({
			activeTab : 0,//é»˜è®¤æ¿€æ´»ç¬¬ä¸€ä¸ªtabé¡µ
			animScroll : true,//ä½¿ç”¨åŠ¨ç”»æ»šåŠ¨æ•ˆæœ
			enableTabScroll : true,//tabæ ‡ç­¾è¶…å®½æ—¶è‡ªåŠ¨å‡ºç°æ»šåŠ¨æŒ‰é’®				
			items: [
				{
					title: 'å€Ÿé˜…ç™»è®°',
					layout: 'border',
					tbar:[				
						'&nbsp;&nbsp;<span style=" font-size:12px;font-weight:600;color:#3366FF;">æ¡ˆå·æ ‡é¢˜</span>:&nbsp;&nbsp;',
						{
							xtype:'textfield',
							id:'query_text',
						},				  
						{	
							xtype:'button',text:'æ£€ç´¢',tooltip:'å…¨æ–‡æ£€ç´¢',id:'query',iconCls:'search',
							handler: function() {
								console.log(Ext.getCmp('query_text').value);
								if (Ext.getCmp('query_text').rawValue!=""){
									var grid = Ext.getCmp('archive_jydj_grid');
									grid.store.proxy.url="/desktop/get_archive_where";
									archive_jydj_store.proxy.extraParams.query=Ext.getCmp('query_text').value;
									archive_jydj_store.proxy.extraParams.userid=currentUser.id; 								
									archive_jydj_store.load();
									Ext.getCmp('cdlr').setValue('å…¨æ–‡ï¼š'+Ext.getCmp('query_text').value);
								}
							}
						},
						'->',
						{	
							xtype:'button',text:'å±•å¼€é«˜çº§æŸ¥è¯¢',tooltip:'é«˜çº§æŸ¥è¯¢',id:'gjcx_button',iconCls:'zk',
							handler: function() {
								var gjcx = Ext.getCmp('gjcx_id');
								var bt=Ext.getCmp('gjcx_button');
								//gjcx.collapsed=false;
								if (gjcx.isHidden()){
									bt.setText('æ”¶èµ·é«˜çº§æŸ¥è¯¢');
									gjcx.expand(true);}
								else {
									bt.setText('å±•å¼€é«˜çº§æŸ¥è¯¢');
									gjcx.collapse(true);
								};
							}
						}
					],
					items:[
						{
							id:'gjcx_id',
							region: 'north',
							height: 115,
							layout: 'fit',
							split:true,
							//collapsible: true,
							collapsed:true,
							collapsible: true,
							//title: 'é«˜çº§æŸ¥è¯¢',
							collapseMode:'mini',
							hideCollapseTool:true,
							items: qwjsform
						},
						{
							region: 'center',
							layout: 'fit',
							items: [
							{
								region: 'center',
								layout: 'border',
								items: [{
											region: 'center',
											//iconCls:'icon-grid',
											layout: 'fit',
											split:true,
											items: archiveGrid
										},
										{
											region: 'south',
											id:'jydjlist',
											//iconCls:'icon-grid',
											//title: 'å€Ÿé˜…ç™»è®°åˆ—è¡¨',
											layout: 'fit',
											split:true,
											height:80,
											collapsed:true,
											collapsible: true,
											collapseMode:'mini',
											hideCollapseTool:true,
											items:jydjlist_dj_Grid
										}
								 ]
							}]
						},
						{
							region: 'south',
							//iconCls:'icon-grid',
							id:'dj_form',
							layout: 'fit',
							height: 140,
							split: true,
							collapseMode:'mini',
							collapsible: true,
							//title: '',
							hideCollapseTool:true,
							items:jydjform
						}
					]
				},
				{
					title: 'å€Ÿé˜…ç®¡ç†',
					layout: 'border',
					dockedItems: [
					        {
			                    xtype: 'form',
			                    height: 30,
			                    dock: 'top',
								items: [
			                        {xtype: 'radiogroup',
			                            name:'jyzt',
			                            fieldLabel: 'è¯·é€‰æ‹©å€Ÿé˜…çŠ¶æ€',
			                            columns: 5,
										vertical: true,
			                            items: [
			                                { boxLabel: 'æ­£åœ¨è¯·æ±‚', name: 'jyzt', inputValue: '1' },
											{ boxLabel: 'å·²åŒæ„å€Ÿé˜…', name: 'jyzt', inputValue: '2', checked: true},
											{ boxLabel: 'å·²æ‰“å›å€Ÿé˜…', name: 'jyzt', inputValue: '3'},
											{ boxLabel: 'å·²ç»“æŸå€Ÿé˜…', name: 'jyzt', inputValue: '4'}
			                            ],
										listeners : {
											'change' : function(group, newValue, oldValue) {
												if (newValue.jyzt.length==1) {
												//alert(newValue.jyzt);
													var grid = Ext.getCmp('jydjlc_grid');
													grid.store.proxy.url="/desktop/get_jydjlc_jyzt";
													jydj_jyzt=newValue.jyzt;
													
													jydjlc_store.proxy.extraParams=eval("({userid:" + currentUser.id + ",jyzt:" + newValue.jyzt + "})");
													jydjlc_store.load();
													jydjlist_store.proxy.extraParams.query='';
													jydjlist_store.load();
												}	
											}
										}
			                        }
			                    ]
			                },{xtype: 'toolbar',
					            anchor: '100%',
					            dock: 'bottom',
					            items: [
					                {
					                    xtype: 'button',
										iconCls:'clqq',
					                    text: 'å¤„ç†è¯·æ±‚',
										handler: function() {
											new Ajax.Request("/desktop/get_sort", { 
												method: "POST",
												parameters: eval("({userid:" + currentUser.id + ",qxid:9})"),
												onComplete:	 function(request) {
													if (request.responseText=='success'){
														var grid = Ext.getCmp('jydjlc_grid');
														var records = grid.getSelectionModel().getSelection();
														var record = records[0];
														if (record.data.jyzt==1){
															clqq(record);
														}else
														{
															alert('è¯·é€‰æ‹©å¤„äºå€Ÿé˜…è¯·æ±‚çŠ¶æ€çš„æ•°æ®è¿›è¡Œå¤„ç†ã€‚');
														}
													}else{
														alert('æ‚¨æ— å€Ÿé˜…å®¡æ‰¹çš„æƒé™ã€‚' );
													}
												}
											});												
										}
					                },
					                {
					                    xtype: 'button',
										iconCls:'jyqq',
					                    text: 'è¯·æ±‚å€Ÿé˜…',
										handler: function() {
											//var grid = Ext.getCmp('archive_grid');
											//var records = grid.getSelectionModel().getSelection();
											//var record = records[0];
											jyqq_add_change='1';
											jyqq('record');

										}
					                },
					                {
					                    xtype: 'button',
										iconCls:'xgqq',
					                    text: 'ä¿®æ”¹è¯·æ±‚',
										handler: function() {
											var grid = Ext.getCmp('jydjlc_grid');
											var records = grid.getSelectionModel().getSelection();
											var record = records[0];
											var jyzt=record.data.jyzt;
											if (record.data.jyzt==1 || record.data.jyzt==3){
												jyqq_add_change='2';													
												jyqq(record);
												
											}else{
												alert('è¯·é€‰æ‹©å¤„äºå€Ÿé˜…è¯·æ±‚çŠ¶æ€æˆ–æ‰“å›çŠ¶æ€çš„æ•°æ®è¿›è¡Œåˆ é™¤å¤„ç†ã€‚');
											}
										}
					                },
									{
					                    xtype: 'button',
										iconCls:'delete',
					                    text: 'åˆ é™¤è¯·æ±‚',
										handler: function() {												
											var grid = Ext.getCmp('jydjlc_grid');
											var records = grid.getSelectionModel().getSelection();
											var record = records[0];
											var jyzt=record.data.jyzt;
											if (record.data.jyzt==1 || record.data.jyzt==3){
												var pars="id="+record.data.id;
												Ext.Msg.confirm("æç¤ºä¿¡æ¯","æ˜¯å¦è¦åˆ é™¤å€Ÿé˜…äººä¸ºï¼šï¼"+record.data.jyr+"çš„å€Ÿé˜…ç”³è¯·ï¼Ÿ",function callback(id){
															if(id=="yes"){
																new Ajax.Request("/desktop/delete_jylc", { 
																	method: "POST",
																	parameters: pars,
																	onComplete:	 function(request) {
																		var grid = Ext.getCmp('jydjlc_grid');
																		grid.store.proxy.url="/desktop/get_jydjlc_jyzt";
																		jydjlc_store.proxy.extraParams=eval("({userid:" + currentUser.id + ",jyzt:" + jyzt + "})");
																		jydjlc_store.load();
																		jydjlist_store.proxy.extraParams.query='';
																		jydjlist_store.load();
																	}
																});
															}else{
																//alert('O,no');
															}
													});
											}else{
												alert('è¯·é€‰æ‹©å¤„äºå€Ÿé˜…è¯·æ±‚çŠ¶æ€æˆ–æ‰“å›çŠ¶æ€çš„æ•°æ®è¿›è¡Œåˆ é™¤å¤„ç†ã€‚');
											}
										}													
					                },
					                {
					                    xtype: 'button',
										iconCls:'xjhd',
					                    text: 'é€‰æ‹©è¿˜æ¡£',
										handler: function() {
											var grid = Ext.getCmp('jydjlc_grid');
											var records = grid.getSelectionModel().getSelection();
											if (records.length>0){
												var record = records[0];
												if (record.data.jyzt==2){
												
														var jylc_pars="id:"+record.data.id;
														var jylist_grid= Ext.getCmp('jydjlist_grid');
														var jylist_records= jylist_grid.getSelectionModel().getSelection();
														if (jylist_records.length>0){
															var ids=[];
															Ext.Array.each(jylist_records,function(record){
																ids.push(record.get("id"));																																		
															});
															jylc_pars="({"+jylc_pars+",ids:'" +ids+"'})";
														
															new Ajax.Request("/desktop/xjhd_jylc", { 
																method: "POST",
																parameters: eval(jylc_pars),
																onComplete:	 function(request) {
																	var grid = Ext.getCmp('jydjlc_grid');
																	grid.store.proxy.url="/desktop/get_jydjlc_jyzt";
																	jydjlc_store.proxy.extraParams=eval("({userid:" + currentUser.id + ",jyzt:2})");
																	jydjlc_store.load();
																	jydjlist_store.proxy.extraParams.query='';
																	jydjlist_store.load();
																}
															});
														}else{
															alert('æ‚¨æœ€å°‘è¦é€‰æ‹©ä¸€æ¡æ•°æ®è¿›è¡Œè¿˜æ¡£ã€‚');
														}
												}else
												{
													alert('è¯·é€‰æ‹©å¤„äºå·²åŒæ„å€Ÿé˜…çŠ¶æ€çš„æ•°æ®è¿›è¡Œå¤„ç†ã€‚');
												}
											}else
											{
												alert('æ‚¨æœ€å°‘è¦é€‰æ‹©ä¸€æ¡æ•°æ®è¿›è¡Œè¿˜æ¡£ã€‚');
											}
										}
					                },
					                {
					                    xtype: 'button',
										iconCls:'hd',
					                    text: 'å…¨éƒ¨è¿˜æ¡£',
										handler: function() {
											var grid = Ext.getCmp('jydjlc_grid');
											var records = grid.getSelectionModel().getSelection();
											var record = records[0];
											if (record.data.jyzt==2){
												var pars="id="+record.data.id;
												new Ajax.Request("/desktop/qbhd_jylc", { 
													method: "POST",
													parameters: pars,
													onComplete:	 function(request) {
														var grid = Ext.getCmp('jydjlc_grid');
														grid.store.proxy.url="/desktop/get_jydjlc_jyzt";
														jydjlc_store.proxy.extraParams=eval("({userid:" + currentUser.id + ",jyzt:2})");
														jydjlc_store.load();
														jydjlist_store.proxy.extraParams.query='';
														jydjlist_store.load();
													}
												});
											}else
											{
												alert('è¯·é€‰æ‹©å¤„äºå·²åŒæ„å€Ÿé˜…çŠ¶æ€çš„æ•°æ®è¿›è¡Œå¤„ç†ã€‚');
											}
										}
					                },
					                {
					                    xtype: 'button',
										iconCls:'tj',
					                    text: 'æ¡£æ¡ˆåˆ©ç”¨ç»Ÿè®¡',
										handler: function() {
											jytj();
										}
					                }
					            ]
					        }
					    ],
					items:[{
							region: 'center',
							//iconCls:'icon-grid',
							layout: 'fit',
							split:true,
							width:100,
							items: jydjlc_grid

						},{
							region: 'east',
							//iconCls:'icon-grid',
							layout: 'border',
							split:true,
							width:550,
							items:[{
									region: 'center',
									//iconCls:'icon-grid',
									layout: 'fit',
									split:true,
									height:100,
									//width:100,
									items: jydjlist_grid
								},{
									region: 'south',
									//iconCls:'icon-grid',
									layout: 'fit',
									split:true,
									height:200,
									items: [{
						              xtype: 'box', //æˆ–è€…xtype: 'component',
						              id: 'preview_img_qz',
									  layout: 'fit',
						              //width: 350, //å›¾ç‰‡å®½åº¦
						              autoEl: {
						                tag: 'img',    //æŒ‡å®šä¸ºimgæ ‡ç­¾
						                alt: ''      //æŒ‡å®šurlè·¯å¾„
						              }
						            }]
								}]
							}]
					
				},
				{
					title: 'ä¸“é¡¹å€Ÿé˜…',
					layout: 'border',
					listeners: {
	                    activate: function(tab){
	                        zxjydjlc_store.load();
	                    }
	                },
					dockedItems:[
						{
							xtype: 'toolbar',
		            		anchor: '100%',
		            		dock: 'bottom',
			            	items: [			                
								'&nbsp;&nbsp;<span style=" font-size:12px;font-weight:600;color:#3366FF;">å€Ÿé˜…äºº</span>:&nbsp;&nbsp;',
								{
									xtype:'textfield',
									id:'zx_jyr'									
								},
								{	
									xtype:'button',text:'åŒæ„æŸ¥çœ‹',tooltip:'åŒæ„æŸ¥çœ‹',id:'zx_yes',iconCls:'save',
									handler: function() {
										if (Ext.getCmp('zx_jyr')==undefined){
											alert("è¯·æ‚¨è¾“å…¥å€Ÿé˜…äººå†åŒæ„æŸ¥çœ‹ã€‚");											
										}else{
											root=Ext.getCmp('image_tree1').store.getRootNode();
											insert_qx="";
											get_mlqx_NodesChecked(root);										
											if (insert_qx==""){
												alert("è¯·æ‚¨é€‰æ‹©ä¸€äº›æ‰«ææ–‡ä»¶å†åŒæ„æŸ¥çœ‹ã€‚");
											}else{
											
												insert_qx="({imageids:'" + insert_qx + "',jyr:'" + Ext.getCmp('zx_jyr').value + "',zxjyid:'" + zxjyid + "'})";
												new Ajax.Request("/desktop/insert_zxjylist", { 
													method: "POST",
													parameters: eval(insert_qx),
													onComplete:	 function(request) {
														if (request.responseText=='success'){
															alert("åŒæ„æŸ¥çœ‹æˆåŠŸã€‚");												
														}else{
															alert("åŒæ„æŸ¥çœ‹å¤±è´¥ï¼Œè¯·é‡æ–°åŒæ„ã€‚");
														}
													}
												});									
											}
										}										
									}
								},
								{	
									xtype:'button',text:'è¯»å–èº«ä»½è¯',tooltip:'è¯»å–èº«ä»½è¯',id:'zx_sfz',iconCls:'option',
									handler: function() {									
												new Ajax.Request("/desktop/get_sfz", { 
													method: "POST",
													//parameters: eval(insert_qx),
													onComplete:	 function(request) {
														reques=request.responseText.split(':');
														if (reques[0]=='success'){
															sfz=reques[1].split(";")
															Ext.getCmp('zx_jyr').setValue(sfz[0]);
														
														}else{
															alert(reques[1]);
														}
													}
												});																													
									}
								}
							]
						}
					],
					tbar:[
						{	
							xtype:'button',text:'åˆ·æ–°è¯·æ±‚',tooltip:'åˆ·æ–°è¯·æ±‚',id:'zx_refresh',iconCls:'refresh',
							handler: function() {
								zxjydjlc_store.load();									
							}
						},
						{	
							xtype:'button',text:'åˆ é™¤è¯·æ±‚',tooltip:'åˆ é™¤è¯·æ±‚',id:'zx_del',iconCls:'delete',
							handler: function() {
								new Ajax.Request("/desktop/delete_zxjy", { 
									method: "POST",
									parameters: '',
									onComplete:	 function(request) {
										if (request.responseText=='success'){
											alert("åˆ é™¤æˆåŠŸã€‚");	
											zxjydjlc_store.load();												
										}else{
											alert("åˆ é™¤å¤±è´¥ï¼Œè¯·é‡æ–°åˆ é™¤ã€‚");
										}
									}
								});								
							}
						},
						'&nbsp;&nbsp;<span style=" font-size:12px;font-weight:600;color:#3366FF;">æ¡ˆå·æ ‡é¢˜</span>:&nbsp;&nbsp;',
						{
							xtype:'textfield',
							id:'zx_ajtm',
						},
						'&nbsp;&nbsp;<span style=" font-size:12px;font-weight:600;color:#3366FF;">å·å†…é¢˜å</span>:&nbsp;&nbsp;',
						{
							xtype:'textfield',
							id:'zx_tm',
						},
						'&nbsp;&nbsp;<span style=" font-size:12px;font-weight:600;color:#3366FF;">æ–‡å·</span>:&nbsp;&nbsp;',
						{
							xtype:'textfield',
							id:'zx_wh',
						},				  
						{	
							xtype:'button',text:'æ£€ç´¢',tooltip:'å…¨æ–‡æ£€ç´¢',id:'zx_query',iconCls:'search',
							handler: function() {
								var grid = Ext.getCmp('archive_grid');
								if (Ext.getCmp('zx_ajtm').value==undefined && Ext.getCmp('zx_tm').value==undefined && Ext.getCmp('zx_wh').value==undefined){
									alert("è¯·è¾“å…¥ä¸€ä¸ªæŸ¥è¯¢æ¡ä»¶ã€‚");										
								}else{
									if (Ext.getCmp('zx_ajtm').value==undefined){
										ajtm=''}
									else{
										ajtm=Ext.getCmp('zx_ajtm').value
									};
									if (Ext.getCmp('zx_tm').value==undefined){
										tm=''}
									else{
										tm=Ext.getCmp('zx_tm').value
									};
									if (Ext.getCmp('zx_wh').value==undefined){
										wh=''}
									else{
										wh=Ext.getCmp('zx_wh').value
									};										
									if (ajtm=="" && tm =="" && wh==""){
										alert("è¯·è¾“å…¥ä¸€ä¸ªæŸ¥è¯¢æ¡ä»¶ã€‚");										
									}else{
										new Ajax.Request("/desktop/insert_zxjy", { 
											method: "POST",
											parameters: eval("({ajtm:'" + ajtm + "',tm:'" + tm + "',wh:'" + wh+ "'})"),
											onComplete:	 function(request) {
												zxjydjlc_store.load();	
											}
										});
									}
								}																
							}
						}
					],
					items:[
						{
							region: 'center',
							layout: 'border',
							items: 
							[{
										region: 'center',
										//iconCls:'icon-grid',
										layout: 'fit',
										split:true,
										width:100,
										items: zxjydjlc_grid
									},{
										region: 'east',
										//iconCls:'icon-grid',
										layout: 'fit',
										split:true,
										width:550,
										items: zxjydjlist_grid
							}]
						},
						{
							region: 'south',
							layout: 'border',
							height: 380,
							split: true,
							collapseMode:'mini',
							collapsible: true,
							//title: '',
							hideCollapseTool:true,
							items:[
								{
									region: 'center',
									//iconCls:'icon-grid',
									layout: 'fit',
									split:true,
									//width:100,
									items: image_tree1

								},
								{
									region: 'east',
									//iconCls:'icon-grid',
									layout: 'fit',
									split:true,
									width:550,
									items: [{
						              xtype: 'box', //æˆ–è€…xtype: 'component',
						              id: 'preview_img',
									  layout: 'fit',
						              //width: 350, //å›¾ç‰‡å®½åº¦
						              autoEl: {
						                tag: 'img',    //æŒ‡å®šä¸ºimgæ ‡ç­¾
						                alt: ''      //æŒ‡å®šurlè·¯å¾„
						              }
						            }]
								}
							]
						}
					]
				}
			]	
		});			

	    if(!win){
	          win = desktop.createWindow({
	              id: 'borrowman',
	              title:'å€Ÿé˜…ç®¡ç†',
	              width:1000,
	              height:600,
	              iconCls: 'borrowman',
	              animCollapse:false,
				  maximized:true,
	              border: false,
	              hideMode: 'offsets',
				  layout: 'border',
				ã€€ã€€split:true,
				ã€€ã€€items:
					[{
						region: 'center',
						layout: 'fit',
						split:true,
						items:tabPanel
				  	}]
			  });             
	    }
	    new Ajax.Request("/desktop/get_sort", { 
      		method: "POST",
	      	parameters: eval("({userid:" + currentUser.id + ",qxid:4})"),
	      	onComplete:	 function(request) {
	      		if (request.responseText=='success'){
	    			win.show();
					Ext.QuickTips.init();
	      		}else{
	      			alert('æ‚¨æ— å€Ÿé˜…ç®¡ç†çš„æƒé™ã€‚');
					Ext.getCmp('borrowman').close();
	      		}
	      	}
      	});
		Ext.getCmp('czrid').setValue(currentUser.id);
	    return win;
	}
});

"digest"%47b4486414c8f3663bc3556c83b45639"_version"%9cfc68f0c07d7d7b23b81489df2752d9"lengthiÑ:@created_atf1380156957.6944251 qv:@compressedF